<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>泡藥計算器</title>
  <!-- 引入 Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f4ece6;
      font-family: 'Roboto', sans-serif;
    }
    .table-container {
      margin-top: 30px;
    }
    h2 {
      color: #5d4037;
      margin-top: 40px;
      text-align: center;
    }
    .order-content {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /*把輸入框的上下箭頭移除*/
    input[type=number]::-webkit-inner-spin-button, 
    input[type=number]::-webkit-outer-spin-button { 
      -webkit-appearance: none;
      margin: 0;
    }
    input[type=number] {
      -moz-appearance: textfield;
    }

   
  </style>
</head>
<body>

<div class="container table-container text-center">

  <!-- 水份計算器 -->
  <h2>水份計算器</h2>

  <table class="table table-container table-bordered align-middle">
    <thead class="table-dark">
      <tr>
        <th style="width: 100px;">說明</th>
        <th>輸入</th>
        <!-- <th style="width: 50%;">輸出</th> -->
      </tr>
    </thead>
    <tbody>

      <!--BW / TDF列-->
      <tr>
        <td>BW / TDF</td>
        <td>
          <div class="row">
            <div class="col">
              <div class="input-group">
                <input type="number" id="bwFluid" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">g</span>
              </div>
            </div>
            <div class="col">
              <div class="input-group">
                <input type="number" id="tdf" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">ml/kg/day</span>
              </div>
            </div>
          </div>
        </td>
      </tr>

      <!--PO列-->
      <tr>
        <td>PO</td>
        <td>
          <div class="row">
            <div class="col">
              <div class="input-group">
                <select id="HM" class="form-select text-center" style="background-color: #f8f9fa;" onchange="updateFluid()">
                  <option value=""></option>
                  <option value="HM">HM</option>
                </select> 
                <span class="input-group-text">/</span>
                <select id="formula" class="form-select text-center" style="background-color: #f8f9fa;" onchange="updateFluid()">
                  <option value=""></option>
                  <option value="16%PF">16%PF</option>
                  <option value="15%PDF">15%PDF</option>
                  <option value="14%RF">14%RF</option>
                </select> 
              </div>
            </div>
            <div class="col">
              <div class="input-group">
                <input type="text" id="po" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">ml/day</span>
              </div>    
            </div>
          </div>
        </td>
      </tr>

      <!--TPN列-->
      <tr>
        <td>TPN</td>
        <td>
          <div class="row">
            <div class="col">
              <div class="input-group">
              <span class="input-group-text">AA</span>
              <select id="tpnAA" class="form-select text-center" style="background-color: #f8f9fa;" onchange="updateFluid()">
                <option value="25%">2.5</option>
                <option value="30%">3.0</option>
                <option value="33%">3.3</option>
                <option value="35%">3.5</option>
                <option value="40%">4.0</option>
                <option value="50%">5.0</option>
              </select> 
              </div>
            </div>
            <div class="col">
              <div class="input-group">
                <input type="number" id="tpnGrams" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">g/kg/day</span>
              </div>
            </div>
            <div class="col">
              <div class="input-group">
                <input type="number" id="tpnHours" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">hrs</span>
              </div>
            </div>
          </div>
        </td>
      </tr>

      <!--LIPID列-->
      <tr>
        <td>Lipid</td>
        <td>
          <div class="row">
            <div class="col">
              <select id="lipidChoice" class="form-select text-center" style="background-color: #f8f9fa;" onchange="updateFluid()">
                <option value="smof">SMOF</option>
                <option value="Omegaven">Omegaven</option>
              </select>             
            </div>
            <div class="col">
              <div class="input-group">
                <input type="number" id="lipidGrams" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">g/kg/day</span>
              </div>      
            </div>
            <div class="col">
              <div class="input-group">
                <input type="number" id="lipidHours" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">hrs</span>
              </div>
            </div>
          </div>
        </td>
      </tr>

      <!--other-->
      <tr>
        <td>其他</td>
        <td>
          <div class="row">
            <div class="col">
              <div class="input-group">
                <input type="number" id="mlHr" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">ml/hr</span>
              </div>
            </div>
            <div class="col">
              <div class="input-group">
                <input type="number" id="mlDay" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">ml/day</span>
              </div>    
            </div>
          </div>
        </td>
      </tr>


      <!--普通IV列-->
      <tr>
        <td>普通IV</td>
        <td>
          <div class="row">
            <div class="col">
              <select id="regularIVChoice" class="form-select text-center" onchange="updateFluid()">
                <option value=""></option>
                <option value="D10W">D10W</option>
                <option value="D5W">D5W</option>
                <option value="D0.225S(500) + 2PC D50W">D0.225S(500) + 2PC D50W</option>
                <option value="D0.225S(500)">D0.225S(500)</option>
              </select>    
            </div>
            <div class="col">
              <div class="input-group">
                <input type="number" id="regularIV" class="form-control text-center" oninput="updateFluid()">
                <span class="input-group-text">ml/hr</span>
              </div>      
            </div>
          </div>
        </td>
      </tr>
      <!-- 輸出 -->
      <tr>
        <td rowspan="8">醫囑</td>
        <td>
          <div class="order-content">
            <span id="bwOutput"></span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999" onclick="copyToClipboard('bwOutput', this)">Copy</button>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="order-content">
            <span id="tdfOutput"></span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999" onclick="copyToClipboard('tdfOutput', this)">Copy</button>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="order-content">
            <span id="poOutput"></span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999"onclick="copyToClipboard('poOutput', this)">Copy</button>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="order-content">
            <div class="input-group-text">
              <input class="form-check-input" type="checkbox" id="makeUp" value="" aria-label="Checkbox for following text input">
              <span>（補）</span>
            </div>
            <span id="tpnOutput"></span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999" onclick="copyToClipboard('tpnOutput', this)">Copy</button>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="order-content">
            <span id="lipidOutput"></span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999"onclick="copyToClipboard('lipidOutput', this)">Copy</button>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="order-content">
            <span id="mlHrOutput"></span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999"onclick="copyToClipboard('mlHrOutput', this)">Copy</button>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="order-content">
            <span id="mlDayOutput"></span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999"onclick="copyToClipboard('mlDayOutput', this)">Copy</button>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="order-content">
            <span id="regularIVOutput"></span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999"onclick="copyToClipboard('regularIVOutput', this)">Copy</button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>


  <!-- 藥物泡法計算器 -->
  <h2>藥物泡法計算器</h2>


  <table class="table align-middle table-container table-bordered">
    <thead class="table-dark">
      <tr>
        <th style="width: 15%;">體重</th>
        <th style="width: 18%;">藥物名稱</th>
        <th style="width: 15%;">目標流速</th>
        <th style="width: 17%;">目標濃度</th>
        <th style="width: 10%;">最後總量</th>
        <th style="width: 15%;">稀釋液</th>
        <th style="width: 10%">原液濃度</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <div class="input-group">
            <input type="number" id="bwDrug" class="form-control text-center" oninput="updateDrugOrder()">
            <span class="input-group-text">kg</span>
          </div>
        </td>
        <td>
          <select id="drug0" class="form-select text-center" onchange="updateDrugOrder()">
            <option value="Dopamine"      >Dopamine       </option>
            <option value="Dobutamine"    >Dobutamine     </option>
            <option value="Milrinone"     >Milrinone      </option>
            <option value="Epinephrine"   >Epinephrine    </option>
            <option value="Midazolam"     >Midazolam      </option>
            <option value="Fentanyl"      >Fentanyl       </option>
            <option value="Bumetanide"    >Bumetanide     </option>
            <option value="Norepinephrine">Norepinephrine </option>
            <option value="Nicardipine"   >Nicardipine    </option>
            <option value="Nitroglycerin" >Nitroglycerin  </option>
            <option value="Labetalol"     >Labetalol      </option>
            <option value="PGE1"          >PGE1           </option>
            <option value="Vasopressin"   >Vasopressin    </option>
            <option value="Isoproterenol" >Isoproterenol  </option>
            <option value="Rocuronium"    >Rocuronium     </option>
            <option value="Cisatracurium" >Cisatracurium  </option>
            <option value="Morphine"      >Morphine       </option>
            <option value="Lorazepam"     >Lorazepam      </option>
            <option value="Ketamine"      >Ketamine       </option>
            <option value="Propofol"      >Propofol       </option>
            <option value="MgSO4"         >MgSO4          </option>
            <option value="Lidocaine"     >Lidocaine      </option>
            <!-- More options -->
          </select>
        </td>
        <td>
          <div class="input-group">
            <input type="number" id="flowRate0" class="form-control text-center" oninput="updateDrugOrder()">
            <span class="input-group-text">ml/hr</span>
          </div>
        </td>
        <td>
          <div class="input-group">
            <input type="number" id="targetConcentration0" class="form-control text-center" oninput="updateDrugOrder()">
            <span id="rateUnit" class="input-group-text">mcg/kg/min</span>
          </div>
        </td>
        <td>
          <div class="input-group">
            <input type="number" id="totalVolume0" class="form-control text-center" oninput="updateDrugOrder()">
            <span class="input-group-text">ml</span>
          </div>
        </td>
        <td>
          <select id="diluter0" class="form-select text-center" onchange="updateDrugOrder()">
            <option value="D5W">D5W</option>
            <option value="N/S">N/S</option>
            <option value="D/W">D/W</option>
          </select>
        </td>
        <td><span id="originalConcentration0"></span></td>
      </tr>

      <!-- 醫囑 output -->
      <tr>
        <td><span>醫囑</td>
        <td colspan="6">
          <div class="order-content">
            <span id="orderText">醫囑</span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999"onclick="copyToClipboard('orderText', this)">COPY</button>
          </div>
        </td>
      </tr>

      <!-- 藥囑 output -->
      <tr>
        <td><span>藥囑</td>
        <td colspan="6">
          <div class="order-content">
            <span id="medText">藥囑</span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999"onclick="copyToClipboard('medText', this)">COPY</button>
          </div>
        </td>
      </tr>

      <!-- PURE LINE output -->
      <tr>
        <td><span>Pure Line</td>
        <td colspan="6">
          <div class="order-content">
            <span id="purelineOrderText">Pure Line</span>
            <button class="btn btn-dark" style="margin-left: auto; " tabindex="999"onclick="copyToClipboard('purelineOrderText', this)">COPY</button>
          </div>
        </td>
      </tr>

    </tbody>
  </table>
</div>

<!-- 引入 math.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.4.0/math.js"></script>

<script>
  // 更新fluid計算
  function updateFluid() {

    // BW 輸出
    const bwFluid = parseFloat(document.getElementById('bwFluid').value) || 0;
    document.getElementById('bwOutput').textContent = `BW: ${bwFluid} g`;

    // TDF 輸出
    const tdf = parseFloat(document.getElementById('tdf').value) || 0;
    let totalTDF = roundToDecimalPlaces(tdf*bwFluid/1000, 1);
    document.getElementById('tdfOutput').textContent = `Total daily fluid: ${tdf} ml/kg/day = total ${totalTDF} ml/day`;

    // PO 輸出 (假設直接輸出 PO 值)
    const po = document.getElementById('po').value;
    const HM = document.getElementById('HM').value;
    const formula = document.getElementById('formula').value;
    let parseResult = parsePO(po, HM, formula);
    document.getElementById('poOutput').textContent = parseResult;

    // TPN 輸出示例
    const tpnAA = document.getElementById('tpnAA').value;
    const tpnGrams = parseFloat(document.getElementById('tpnGrams').value) || 0;
    const tpnHours = document.getElementById('tpnHours').value || 24; 
    const makeUp = document.getElementById('makeUp').value;
    let tpnOutput = "";
    let tpnTotal = 0;
    tpnOutput += `${tpnGrams*bwFluid/1000}`;
    document.getElementById('tpnOutput').textContent = `AA: ${tpnAA}, Gram: ${tpnGrams}, 補不足`;

    // SMOF/Omegaven 輸出示例
    const lipidChoice = document.getElementById('lipidChoice').value;
    const lipidGrams = parseFloat(document.getElementById('lipidGrams').value) || 0;
    let lipidHours = document.getElementById('lipidHours').value || 20;
    const lipidSpec = {
      "SMOF": {density: 1/5, unit: "g/ml"},
      "Omegaven": {density: 1/10, unit: "g/ml"}
    }
    document.getElementById('lipidOutput').textContent = `${lipidChoice} - Gram: ${lipidGrams}`;


    // ml/hr 輸出示例
    const mlHr = parseFloat(document.getElementById('mlHr').value) || 0;
    document.getElementById('mlHrOutput').textContent = `ml/hr: ${mlHr}`;

    // ml/day 輸出示例
    const mlDay = parseFloat(document.getElementById('mlDay').value) || 0;
    document.getElementById('mlDayOutput').textContent = `ml/day: ${mlDay}`;

    // 普通IV 輸出示例
    const regularIV = parseFloat(document.getElementById('regularIV').value) || 0;
    document.getElementById('regularIVOutput').textContent = `普通IV: ${regularIV}`;
  };

  // 設定藥物資料
  const drugSpecs = {
    'Dopamine'      : { concentration: 40     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Dobutamine'    : { concentration: 12.5   , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Milrinone'     : { concentration: 1      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Epinephrine'   : { concentration: 1      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2},
    'Midazolam'     : { concentration: 5      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Fentanyl'      : { concentration: 0.05   , unit: 'mg/ml' , rateUnit: 'mcg/kg/hr'  , decimalPlace: 3},
    'Bumetanide'    : { concentration: 0.25   , unit: 'mg/ml' , rateUnit: 'mcg/kg/hr'  , decimalPlace: 1},
    'Norepinephrine': { concentration: 1      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2},
    'Nicardipine'   : { concentration: 1      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Nitroglycerin' : { concentration: 0.5    , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2}, //小數點待確定
    'Labetalol'     : { concentration: 5      , unit: 'mg/ml' , rateUnit: 'mg/kg/hr'   , decimalPlace: 2}, //小數點待確定
    'PGE1'          : { concentration: 0.5    , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2},
    'Vasopressin'   : { concentration: 20     , unit: 'U/ml'  , rateUnit: 'mU/kg/min'  , decimalPlace: 0},
    'Isoproterenol' : { concentration: 0.2    , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Rocuronium'    : { concentration: 10     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Cisatracurium' : { concentration: 2      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Morphine'      : { concentration: 10     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2}, //小數點待確定
    'Lorazepam'     : { concentration: 2      , unit: 'mg/ml' , rateUnit: 'mg/kg/hr'   , decimalPlace: 2}, //小數點待確定
    'Ketamine'      : { concentration: 50     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
    'Propofol'      : { concentration: 10     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2}, //小數點待確定
    'MgSO4'         : { concentration: 100    , unit: 'mg/ml' , rateUnit: 'mg/kg/hr'   , decimalPlace: 1},
    'Lidocaine'     : { concentration: 50     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2}  //小數點待確定
  };

  // 更新藥物濃度及計算抽取量
  function updateDrugOrder() {
    const drug = document.getElementById("drug0").value;
    const originalConcentration = drugSpecs[drug].concentration;
    const originalUnit = drugSpecs[drug].unit;
    const targetRateUnit = drugSpecs[drug].rateUnit;
    const decimal = drugSpecs[drug].decimalPlace;
    document.getElementById("originalConcentration0").textContent = originalConcentration + " " + originalUnit;
    document.getElementById("rateUnit").textContent = `(${targetRateUnit})`;    

    const bwDrug = parseFloat(document.getElementById("bwDrug").value);
    const flowRate = parseFloat(document.getElementById("flowRate0").value);
    const targetConcentration = parseFloat(document.getElementById("targetConcentration0").value);
    const totalVolume = parseFloat(document.getElementById("totalVolume0").value);
    const diluter = document.getElementById("diluter0").value;

    let orderText = "醫囑";
    let medText = "藥囑";
    let purelineOrderText = "Pure Line";
    
    if (drug && bwDrug && flowRate && targetConcentration && totalVolume) {

      //計算重量單位轉換
      const unitOringinal = originalUnit.split("/")[0];
      const unitTarget  = targetRateUnit.split("/")[0];
      const unitComb = `${unitOringinal}-${unitTarget}`;
      let unitConversionRatio = 1;
      switch (unitComb) {
        case 'mg-mcg': unitConversionRatio = 1/1000; break;
        case 'U-mU'  : unitConversionRatio = 1/1000; break;
        case 'mg-mg' : unitConversionRatio = 1; break;
        default: unitConversionRatio = 1; break;
      }
      
      //計算時間單位轉換
      const timeTarget = targetRateUnit.split("/")[2];
      let timeConversionRatio = 1;
      if (timeTarget === 'min') timeConversionRatio = 60;

      
      const dose = roundToDecimalPlaces( targetConcentration * timeConversionRatio * bwDrug * unitConversionRatio / flowRate * totalVolume, decimal);  //計算提取量    
      const extractedVolume = roundToDecimalPlaces( totalVolume - dose / originalConcentration, 1 ); //計算溶劑體積
      const pureLineConcentration = roundToDecimalPlaces( 1 * originalConcentration / unitConversionRatio / bwDrug / timeConversionRatio, 1);

      orderText = `${drug} ${dose+unitOringinal} in ${diluter} ${extractedVolume}ml (total ${totalVolume}ml), run ${flowRate}ml/hr = ${targetConcentration + targetRateUnit} `;
      medText = `${drug} ${dose+unitOringinal} in ${diluter} ${extractedVolume}ml (total ${totalVolume}ml), run as order`;
      purelineOrderText =  `${drug} 1 ml/hr = ${pureLineConcentration + " " + targetRateUnit}`;     
    }

    document.getElementById("orderText").textContent = orderText;
    document.getElementById("medText").textContent = medText;
    document.getElementById("purelineOrderText").textContent = purelineOrderText;
  }

  // 複製按鈕
  function copyToClipboard(id, button) {
    const textToCopy = document.getElementById(id).textContent;
    const originalText = button.textContent;

    navigator.clipboard.writeText(textToCopy);
    button.textContent = "Copied";
    setTimeout(() => {
      button.textContent = originalText;
    }, 500);
    button.blur();
  }

  // 四捨五入至小數點第幾位
  function roundToDecimalPlaces(value, decimalPlaces) {
    const factor = Math.pow(10, decimalPlaces); // 計算10的次方
    return Math.round(value * factor) / factor; // 先乘以10的次方再四捨五入，然後除以10的次方
  }


  // 加減乘除
  function calculateExpression(expression) {
    // 移除掉多餘的空格
    expression = expression.replace(/\s+/g, "");

    try {
        // 使用 math.js 的 evaluate 方法計算表達式
        let result = math.evaluate(expression); // 評估數學表達式
        return result;
    } catch (error) {
        console.error("表達式錯誤:", error);
        return null; // 若計算過程中有錯誤，返回 null
    }
  }

  // 解析PO
  function parsePO(expression, HM, formula) {
    const regex = /^(\d+\s*\*\s*\d+)(\s*\+\s*\d+\s*\*\s*\d+)*$/;
    const matchPattern = /(\d+)\s*\*\s*(\d+)/g;
    const poOutputDiv = document.getElementById("poOutput");
    
    let poOutput = [];
    let poResult = "";
    let warning = "";

    // 先檢查是否符合 A*B (+ C*D + E*F ...) 格式
    if (!regex.test(expression)) {
        warning = "格式錯誤: 請輸入 3*2 (+ 6*2 + 9*4 ...)";
        poOutputDiv.innerHTML = warning;
        return warning; // 若格式不正確，提前返回
    }

    // 使用正則表達式解析 "數字 * 數字" 格式
    let match;
    while ((match = matchPattern.exec(expression)) !== null) {
        const [_, base, multiplier] = match;
        poOutput.push({ base: parseInt(base), multiplier: parseInt(multiplier) });
    }

    // 計算 multiplier 的總和
    const multiplierSum = poOutput.reduce((sum, item) => sum + item.multiplier, 0);
    // 檢查 multiplierSum 是否能被 24 整除
    if (24 % multiplierSum !== 0) {
        warning = `格式錯誤: 總共${multiplierSum}餐無法整除24小時`;
        return warning;
    }

    // 生成結果描述
    poResult = poOutput.map((result) => `${result.base} ml * ${result.multiplier} meals`).join(" then ");
    // 移除最後一個元素 (最後一個*幾餐)
    let poResultArray = poResult.split(" * ");
    poResultArray.pop(); 
    poResult = poResultArray.join(" * ");
 
    // 加上餵食頻率
    poResult += ` / Q${24/multiplierSum}H`;

    // 加上奶品
    let diet = HM && formula ? `${HM}/${formula}` : HM || formula || '';
    poResult =  diet ? `${diet}  ${poResult}` : poResult;

    // 加上總量 = total ml/day
    let totalIntake = calculateExpression(expression);
    poResult = `Diet: ${poResult} (= total ${totalIntake} ml/day)`;
    

    return poResult;
  }


  // 在 DOM 加載完成後調用函數
  document.addEventListener("DOMContentLoaded", function() {
    updateDrugOrder(); // 初始化選擇的藥物濃度
    undateDrugList(); // 初始化藥物列表
    updateFluid(); // 初始化fluid
  });


</script>
</body>
</html>
