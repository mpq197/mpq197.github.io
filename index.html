<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <!-- 
    代辦事項
    1. 新增ICD10搜尋功能
    2. 新增問診重點等文件下載
    3. 自動轉換成體重
    4. local storage
    5. 計算PMA, CA
  -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NeoAssist</title>
  <!-- 引入 Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Intro.js CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intro.js/minified/introjs.min.css" />

  <style>
    body {
      background-color: #f1e6d8;
      font-family: 'Roboto', sans-serif;
      color: #333333;
    }

    .card {
      background-color: #faf9f8;
      margin-bottom: 10px;
    }

    .card-header {
      background-color: #333333;
      color: white;
    }

    .nav-tabs {
      display: flex;
      justify-content: space-between;
      border-color: #333333;
      /* 選項平均分配 */
    }

    .nav-tabs .nav-item {
      flex: 1;
      /* 每個項目占同等比例 */
      text-align: center;
      /* 文字置中 */
    }

    .nav-tabs .nav-link {
      color: #777777;
      width: 100%;
      /* 填滿父容器寬度 */
      text-align: center;
      /* 文字置中 */
      border-radius: 0%;
    }

    .nav-tabs .nav-link.active {
      background-color: #333333;
      border-color: #333333;
      color: white;
    }

    .nav-tabs .nav-link:hover {
      border-color: #333333;
    }

    .input-group {
      margin-bottom: 5px;
    }

    /* .input-group-text {
      background-color: #f3ece4;
    } */

    /* 修改聚焦時的邊框顏色，並確保樣式優先級 */
    input:focus,
    textarea:focus,
    select:focus {
      border-color: #333333 !important;
      box-shadow: 0 0 0 0.2rem #333333 !important;
      /* 強制使用深棕色邊框陰影 */
    }

    /*把輸入框的上下箭頭移除*/
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type=number] {
      -moz-appearance: textfield;
    }

    /* 移除預設的向下箭頭 */
    .form-select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      background-image: none !important;
      padding-right: 0.75rem !important;
    }

    .copy-item {
      background-color: #faf9f8;
      border-color: #dee2e6;
      cursor: pointer;
    }

    .copy-item:hover,
    input:hover,
    .form-select:hover {
      background-color: #e9e7e5 !important;
      /* 統一的 Hover 顏色 */
      color: #333333;
      /* 保持文字顏色一致 */
    }
  </style>
</head>

<body>
  <!-- 分頁導航欄 -->
  <ul class="nav nav-tabs" id="mainTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="fluidTab" data-bs-toggle="tab" data-bs-target="#fluidContent" type="button"
        role="tab" aria-controls="fluidContent" aria-selected="true">
        水分計算
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="medicationTab" data-bs-toggle="tab" data-bs-target="#medicationContent" type="button"
        role="tab" aria-controls="medicationContent" aria-selected="false">
        藥物泡法
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="growthTab" data-bs-toggle="tab" data-bs-target="#growthContent" type="button"
        role="tab" aria-controls="growthContent" aria-selected="false">
        生長測量
      </button>
    </li>
  </ul>

  <!-- 分頁內容區域 -->
  <div class="tab-content" id="mainTabContent">
    <!-- 分頁 1: 水分計算 -->
    <div class="tab-pane show active" id="fluidContent" role="tabpanel" aria-labelledby="fluidTab">
      <div class="container mt-4">
        <div class="row mb-3">
          <div class="col">
            <div class="card h-100" id="fluid_content">
              <!-- 水分計算 header -->
              <div class="card-header text-center pt-0 pb-0">
                <ul class="nav nav-tabs" id="fluidContentTabs" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button class="nav-link active" style="font-size: large;" id="fluid_basic_tab" data-bs-toggle="tab" type="button" role="tab" aria-controls="basic" aria-selected="true" onclick="fluidVersionToggle('basic')">
                      水分計算簡易版
                    </button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button class="nav-link" style="font-size: large;" id="fluid_advanced_tab" data-bs-toggle="tab" type="button" role="tab" aria-controls="advanced" aria-selected="false" onclick="fluidVersionToggle('advanced')">
                      水分計算進階版
                    </button>
                  </li>
                </ul>
              </div>
              <div class="card-body pb-0">
                <div class="input-group" id="fluid_BW_area">
                  <span class="input-group-text justify-content-center" style="width: 15%;">BW</span>
                  <input type="number" id="fluid_BW" class="form-control text-center" oninput="calculateFluid()" />
                  <span class="input-group-text  justify-content-center" style="width: 15%;">g</span>
                </div>
                <div class="input-group" id="fluid_TDF_area">
                  <span class="input-group-text justify-content-center" style="width: 15%;">TDF</span>
                  <input type="number" id="fluid_TDF" class="form-control text-center" oninput="calculateFluid()" />
                  <span class="input-group-text  justify-content-center" style="width: 15%;">ml/kg/day</span>
                </div>
                <div class="input-group" id="fluid_PO_area">
                  <span class="input-group-text justify-content-center" style="width: 15%;">PO</span>
                  <select id="fluid_PO_HM" class="form-select text-center" onchange="calculateFluid()">
                    <option value="HM">HM</option>
                    <option value=""></option>
                  </select>
                  <span class="input-group-text" style="background-color: #ffffff;">/</span>
                  <select id="fluid_PO_formula" class="form-select text-center" onchange="calculateFluid()">
                    <option value="16%PF">16%PF</option>
                    <option value="15%PDF">15%PDF</option>
                    <option value="14%RF">14%RF</option>
                    <option value=""></option>
                  </select>
                  <input type="text" id="fluid_PO" class="form-control text-center" oninput="calculateFluid()" />
                  <span class="input-group-text  justify-content-center" style="width: 15%;">ml/day</span>
                </div>
                <div class="input-group" id="fluid_TPN_area">
                  <span class="input-group-text justify-content-center" style="width: 15%;">TPN</span>
                  <select id="fluid_TPN_AA" class="form-select text-center" onchange="calculateFluid()">
                    <option value="0.025">AA 2.5</option>
                    <option value="0.030">AA 3.0</option>
                    <option value="0.033">AA 3.3</option>
                    <option value="0.035">AA 3.5</option>
                    <option value="0.040">AA 4.0</option>
                    <option value="0.050">AA 5.0</option>
                  </select>
                  <input type="number" id="fluid_TPN_grams" class="form-control text-center" oninput="calculateFluid()" />
                  <span class="input-group-text">g/kg/day</span>
                  <input type="number" id="fluid_TPN_hours" min="0" max="24" class="form-control text-center" placeholder="-" oninput="calculateFluid()" />
                  <span class="input-group-text  justify-content-center" style="width: 15%;">hrs</span>
                </div>
                <div class="input-group advanced-version-only" id="fluid_TPN_content_area">
                  <span class="input-group-text justify-content-center" style="width: 15%;"></span>
                  <select id="fluid_TPN_dex" class="form-select text-center" onchange="calculateFluid()">
                    <option value="2.5">Dex 2.5</option>
                    <option value="5">Dex 5.0</option>
                    <option value="7.5">Dex 7.5</option>
                    <option value="10" selected>Dex 10.0</option>
                    <option value="12.5">Dex 12.5</option>
                    <option value="15">Dex 15.0</option>
                    <option value="17.5">Dex 17.5</option>
                    <option value="20">Dex 20.0</option>
                    <option value="22.5">Dex 22.5</option>
                    <option value="25">Dex 25.0</option>
                  </select>
                  <select id="fluid_TPN_Na" class="form-select text-center" onchange="calculateFluid()">
                    <option value="0" >Na  0</option>
                    <option value="10">Na 10</option>
                    <option value="20">Na 20</option>
                    <option value="30">Na 30</option>
                    <option value="40" selected>Na 40</option>
                    <option value="50">Na 50</option>
                    <option value="60">Na 60</option>
                    <option value="60">Na 70</option>
                    <option value="60">Na 80</option>
                  </select>
                  <select id="fluid_TPN_K" class="form-select text-center" onchange="calculateFluid()">
                    <option value="0" >K  0</option>
                    <option value="10">K 10</option>
                    <option value="20" selected>K 20</option>
                    <option value="30">K 30</option>
                    <option value="40">K 40</option>
                    <option value="50">K 50</option>
                    <option value="60">K 60</option>
                    <option value="70">K 70</option>
                    <option value="80">K 80</option>
                  </select>
                  <select id="fluid_TPN_Ca" class="form-select text-center" onchange="calculateFluid()">
                    <option value="20" selected>Ca 20</option>
                    <option value="30">Ca 30</option>
                    <option value="40">Ca 40</option>
                  </select>
                  <select id="fluid_TPN_P" class="form-select text-center" onchange="calculateFluid()">
                    <option value="0">P 0</option>
                    <option value="6">P 6</option>
                    <option value="9" selected>P 9</option>
                    <option value="10">P 10</option>
                    <option value="13.5">P 13.5</option>
                    <option value="15">P 15</option>
                    <option value="20">P 20</option>
                  </select>
                  <select id="fluid_TPN_Mg" class="form-select text-center" onchange="calculateFluid()">
                    <option value="0">Mg 0</option>
                    <option value="2">Mg 2</option>
                    <option value="4" selected>Mg 4</option>
                  </select>
                  <span class="input-group-text  justify-content-center" style="width: 15%;"></span>
                </div>
                <div class="input-group" id="fluid_lipid_area">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Lipid</span>
                  <select id="fluid_lipid_type" class="form-select text-center" onchange="calculateFluid()">
                    <option value="SMOF">SMOF</option>
                    <option value="Omegaven">Omegaven</option>
                  </select>
                  <input type="number" id="fluid_lipid_grams" class="form-control text-center" oninput="calculateFluid()" />
                  <span class="input-group-text">g/kg/day</span>
                  <input type="number" id="fluid_lipid_hours" min="16" max="24" class="form-control text-center" placeholder="-" oninput="calculateFluid()" />
                  <span class="input-group-text  justify-content-center" style="width: 15%;">hrs</span>
                </div>
                <div class="input-group" id="fluid_other_in_IO_area">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Other</span>
                  <select name="fluid_other_in_IO_base" class="form-select text-center advanced-version-only" onchange="calculateFluid()">
                    <option value=""></option>
                    <option value="3% NaCl">3% NaCl</option>
                  </select>
                  <input type="text" name="fluid_other_in_IO" id="fluid_other_in_IO_default" class="form-control text-center" oninput="calculateFluid()" />
                  <span class="input-group-text  justify-content-center" style="width: 10%;">ml/day</span>
                  <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'fluid_other_in_IO')">+</button>
                </div>
                <div class="input-group" id="fluid_other_solution_area">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Other</span>
                  <select name="fluid_other_solution_base" class="form-select text-center advanced-version-only" onchange="calculateFluid()">
                    <option value=""></option>
                    <option value="D/W">D/W base</option>
                    <option value="D5W">D5W base</option>
                    <option value="D10W">D10W base</option>
                    <option value="H/S">H/S base</option>
                    <option value="N/S">N/S base</option>
                    <option value="L/R">L/R base</option>
                  </select>
                  <input type="text" name="fluid_other_solution_rate" id="fluid_other_solution_rate_default" class="form-control text-center" oninput="calculateFluid()" />
                  <span class="input-group-text justify-content-center" style="width:10%">ml/hr</span>
                  <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'fluid_other_solution')">+</button>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">普通IV</span>
                  <select id="fluid_regular_IV_type" class="form-select text-center" onchange="calculateFluid()">
                    <option value=""></option>
                    <option value="D5W">D5W</option>
                    <option value="D10W">D10W</option>
                    <option value="D0.225S(500)">D0.225S(500)</option>
                    <option value="D0.225S(500) + 2PC D50W">D0.225S(500) + 2PC D50W</option>
                    <option value="Dex 2.5% in 0.45 Saline">Dex 2.5% in 0.45 saline</option>
                    <option value="H/S">H/S</option>
                    <option value="N/S">N/S</option>
                  </select>
                  <input type="number" id="fluid_regular_IV_rate" class="form-control text-center" oninput="calculateFluid()" />
                  <span class="input-group-text  justify-content-center" style="width: 15%;">ml/hr</span>
                </div>
                <!-- 加入小計算機 -->
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">計算機</span>
                  <input type="text" id="fluid_calc" class="form-control text-center" oninput="fluidCalclator()" />
                  <span class="input-group-text justify-content-center">=</span>
                  <span class="input-group-text justify-content-center" id="fluid_calc_result" style="width: 15%;"></span>
                </div>
              </div>
              <div class="card-footer">
                <div class="input-group d-flex mt-2 mb-2 advanced-version-only" id="fluid_nutrition_area">
                  <span class="input-group-text flex-fill justify-content-center" id="fluid_nutrition_GIR">GIR ___</span>
                  <span class="input-group-text flex-fill justify-content-center" title="mEq/kg/day" id="fluid_nutrition_Na">Na ___</span>
                  <span class="input-group-text flex-fill justify-content-center" title="mEq/kg/day" id="fluid_nutrition_K">K ___</span>
                  <span class="input-group-text flex-fill justify-content-center" title="mEq/kg/day" id="fluid_nutrition_Ca">Ca ___</span>
                  <span class="input-group-text flex-fill justify-content-center" title="mEq/kg/day" id="fluid_nutrition_P">P ___</span>
                  <span class="input-group-text flex-fill justify-content-center" title="mEq/kg/day" id="fluid_nutrition_Mg">Mg ___</span>
                  <span class="input-group-text justify-content-center text-truncate" style="width: 15%;">mEq/kg/day</span>
                </div>
                <div class="row">
                  <div class="col-10">
                    <ul class="list-group mt-2 mb-2" id="fluid_order_output">
                      <li class="list-group-item copy-item" name="fluid_order_outputs">BW:</li>
                      <li class="list-group-item copy-item" name="fluid_order_outputs">Total daily fluid:</li>
                    </ul>    
                  </div>
                  <div class="col-2" style="padding-left: 0%;">
                    <div class="d-flex flex-column justify-content-center align-items-center h-100">
                      <!-- 原本的 Reset 按鈕 -->
                      <button class="btn btn-secondary w-75 mb-2" id="fluid_intro" onclick="fluidIntro()">教學</button>
                      <button class="btn btn-secondary w-75" onclick="resetForm('fluid_content')">Reset</button>
                    </div>
                  </div>
                </div> 
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col">
            <div class="card h-100" id="GIR_content">
              <div class="card-header text-center">GIR計算</div>
              <div class="card-body pb-0">
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">BW</span>
                  <input type="number" id="GIR_BW" class="form-control text-center" oninput="calculateGIR()" />
                  <span class="input-group-text  justify-content-center" style="width: 15%;">g</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Dex</span>
                  <input name="GIR_dex" id="GIR_dex_default_10_percent" type="number" class="form-control text-center" value="10" oninput="calculateGIR()">
                  <span class="input-group-text">%</span>
                  <input name="GIR_rate" type="text" class="form-control text-center" oninput="calculateGIR()">
                  <span class="input-group-text" style="width: 10%;">ml/hr</span>
                  <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'GIR_dex')">+</button>
                </div>   
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Dex</span>
                  <input name="GIR_dex" id="GIR_dex_default_5_percent" type="number" class="form-control text-center" value="5" oninput="calculateGIR()">
                  <span class="input-group-text">%</span>
                  <input name="GIR_rate" type="text" class="form-control text-center" oninput="calculateGIR()">
                  <span class="input-group-text" style="width: 10%;">ml/hr</span>
                  <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'GIR_dex')">+</button>
                </div>   
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Dex</span>
                  <input name="GIR_dex" type="number" class="form-control text-center" oninput="calculateGIR()">
                  <span class="input-group-text">%</span>
                  <input name="GIR_rate" type="text" class="form-control text-center" oninput="calculateGIR()">
                  <span class="input-group-text" style="width: 10%;">ml/hr</span>
                  <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'GIR_dex')">+</button>
                </div>   
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Dex</span>
                  <input name="GIR_dex" type="number" class="form-control text-center" oninput="calculateGIR()">
                  <span class="input-group-text">%</span>
                  <input name="GIR_rate" type="text" class="form-control text-center" oninput="calculateGIR()">
                  <span class="input-group-text" style="width: 10%;">ml/hr</span>
                  <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'GIR_dex')">+</button>
                </div>   
              </div>
              <div class="card-footer">
                <div class="row">
                  <div class="col-10">
                    <div class="input-group d-flex mt-2 mb-2">
                      <span class="input-group-text copy-item flex-fill justify-content-center" id="GIR_result">GIR 0.0</span>
                    </div>    
                  </div>
                  <div class="col-2" style="padding-left: 0%;">
                    <div class="d-flex justify-content-center align-items-center h-100">
                      <button class="btn btn-secondary" onclick="resetForm('GIR_content')">Reset</button>
                    </div>    
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="card h-100" id="dex_content">
              <div class="card-header text-center">普通點滴dextrose計算</div>
              <div class="card-body d-flex align-items-center pb-0">
                <div>
                  <div class="input-group">
                    <span class="input-group-text justify-content-center" style="width: 15%;">Dex</span>
                    <input type="number" id="dextrose_original_concentration" class="form-control text-center" value="5" oninput="calculateDex()" />
                    <span class="input-group-text  justify-content-center" style="width: 15%;">%</span>
                    <input type="number" id="dextrose_original_amount" class="form-control text-center" value="500" oninput="calculateDex()" />
                    <span class="input-group-text  justify-content-center" style="width: 15%;">ml</span>                  
                  </div>
                  <div class="input-group">
                    <span class="input-group-text justify-content-center w-100" style="background-color: transparent; border: 0cm;">+</span>          
                  </div>
                  <div class="input-group">
                    <span class="input-group-text justify-content-center" style="width: 15%;">Dex</span>
                    <input type="number" id="dextrose_add_concentration" class="form-control text-center" value="50" oninput="calculateDex()"/>
                    <span class="input-group-text  justify-content-center" style="width: 15%;">%</span>
                    <input type="number" id="dextrose_add_amount" class="form-control text-center" oninput="calculateDex()" />
                    <span class="input-group-text  justify-content-center" style="width: 15%;">ml</span>                  
                  </div>
                  <div class="input-group">
                    <span class="input-group-text justify-content-center w-100" style="background-color: transparent; border: 0cm;">| |</span>          
                  </div>
                </div>
              </div>
              <div class="card-footer">
                <div class="row">
                  <div class="col-10">
                    <div class="input-group d-flex mt-2 mb-2">
                      <span class="input-group-text copy-item flex-fill justify-content-center" id="dextrose_concentration_final">Dextrose = 0.00 %</span>
                    </div>    
                  </div>
                  <div class="col-2" style="padding-left: 0%;">
                    <div class="d-flex justify-content-center align-items-center h-100">
                      <button class="btn btn-secondary" onclick="resetForm('dex_content')">Reset</button>
                    </div>    
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-4">
          <div class="col">
            <div class="card h-100" id="umbilical_cath_len_content">
              <div class="card-header text-center">UA、UV深度計算</div>
              <div class="card-body pb-0">
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">BW</span>
                  <input type="number" id="umbilical_cath_len_BW" class="form-control text-center" oninput="calculateUmbilicalCathLen()" />
                  <span class="input-group-text  justify-content-center" style="width: 15%;">g</span>
                </div>
              </div>
              <div class="card-footer">
                <div class="row">
                  <div class="col-10">
                    <div class="input-group d-flex mt-2 mb-2">
                      <span class="input-group-text justify-content-center" style="width:30%;">UA</span>
                      <span class="input-group-text copy-item flex-fill justify-content-center" id="umbilical_cath_len_UA"></span>
                    </div>  
                    <div class="input-group d-flex mt-2 mb-2">
                      <span class="input-group-text justify-content-center" style="width:30%;">UV</span>
                      <span class="input-group-text copy-item flex-fill justify-content-center" id="umbilical_cath_len_UV"></span>
                    </div>
                  </div>
                  <div class="col-2" style="padding-left: 0%;">
                    <div class="d-flex justify-content-center align-items-center h-100">
                      <button class="btn btn-secondary" onclick="resetForm('umbilical_cath_len_content')">Reset</button>
                    </div>    
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 分頁 2: 藥物泡法 -->
    <div class="tab-pane" id="medicationContent" role="tabpanel" aria-labelledby="medicationTab">
      <div class="container mt-4">
        <div class="row mb-3">
          <div class="col">
            <div class="card h-100" id="drug_content">
              <div class="card-header text-center">藥物泡法</div>
              <div class="card-body pb-0">
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">BW</span>
                  <input type="text" id="drug_BW" class="form-control text-center" oninput="calculateDrugPreperation()"/>
                  <span class="input-group-text justify-content-center" style="width: 15%;">kg</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Drug</span>
                  <select id="drug_name" class="form-select text-center" title="" onchange="calculateDrugPreperation()">
                    <option value="Dopamine"      >Dopamine       </option>
                    <option value="Dobutamine"    >Dobutamine     </option>
                    <option value="Milrinone"     >Milrinone      </option>
                    <option value="Epinephrine"   >Epinephrine    </option>
                    <option value="Midazolam"     >Midazolam      </option>
                    <option value="Fentanyl"      >Fentanyl       </option>
                    <option value="Bumetanide"    >Bumetanide     </option>
                    <option value="Norepinephrine">Norepinephrine </option>
                    <option value="Nicardipine"   >Nicardipine    </option>
                    <option value="Nitroglycerin" >Nitroglycerin  </option>
                    <option value="Labetalol"     >Labetalol      </option>
                    <option value="PGE1"          >PGE1           </option>
                    <option value="Vasopressin"   >Vasopressin    </option>
                    <option value="Isoproterenol" >Isoproterenol  </option>
                    <option value="Rocuronium"    >Rocuronium     </option>
                    <option value="Cisatracurium" >Cisatracurium  </option>
                    <option value="Morphine"      >Morphine       </option>
                    <option value="Lorazepam"     >Lorazepam      </option>
                    <option value="Ketamine"      >Ketamine       </option>
                    <option value="Propofol"      >Propofol       </option>
                    <option value="MgSO4"         >MgSO4          </option>
                    <option value="Lidocaine"     >Lidocaine      </option>
                    <option value="Insulin"       >Insulin</option>
                    <!-- More options -->
                  </select>
                  <input type="text" id="drug_extract_amount" class="form-control text-center" oninput="calculateDrugPreperation()" />
                  <span class="input-group-text justify-content-center" style="width: 15%;" id="drug_extract_amount_unit">mg</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">In</span>
                  <select id="drug_diluter_name" class="form-select text-center" onchange="calculateDrugPreperation()">
                    <option value="D5W">D5W</option>
                    <option value="N/S">N/S</option>
                    <option value="D/W">D/W</option>
                  </select>  
                  <span class="input-group-text justify-content-center">total</span>
                  <input type="number" id="drug_total_final_volume" class="form-control text-center" oninput="calculateDrugPreperation()" />
                  <span class="input-group-text justify-content-center" style="width: 15%;">ml</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Run</span>
                  <input type="text" id="drug_infusion_rate" class="form-control text-center" oninput="calculateDrugPreperation()" />
                  <span class="input-group-text justify-content-center">ml/hr</span>
                  <span class="input-group-text justify-content-center">=</span>
                  <input type="number" id="drug_infusion_final_rate" class="form-control text-center" oninput="calculateDrugPreperation()" />
                  <span class="input-group-text justify-content-center" id="drug_infusion_final_rate_unit" style="min-width: 15%;">mcg/kg/min</span>
                </div>
              </div>
              <div class="card-footer">
                <div class="row">
                  <div class="col-10">
                    <ul class="list-group mt-2 mb-2">
                      <li class="list-group-item copy-item" id="drug_text_for_order">&nbsp;</li>
                      <li class="list-group-item copy-item" id="drug_text_for_med">&nbsp;</li>
                      <li class="list-group-item copy-item" id="drug_text_for_pure_line">&nbsp;</li>
                    </ul>        
                  </div>
                  <div class="col-2" style="padding-left: 0%;">
                    <div class="d-flex justify-content-center align-items-center h-100">
                      <button class="btn btn-secondary" onclick="resetForm('drug_content')">Reset</button>
                    </div>    
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col">
            <div class="card h-100" id="anti_NB_content">
              <div class="card-header text-center">NB常用抗生素泡法 (測試版，請參考手冊驗算)</div>
              <div class="card-body pb-0">
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">BW</span>
                  <input type="text" id="anti_NB_BW" class="form-control text-center" oninput="calculateAntibioticsForNB()"/>
                  <span class="input-group-text justify-content-center" style="width: 15%;">g</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Drug</span>
                  <select id="anti_NB_drug_name" class="form-select text-center" title="" onchange="calculateAntibioticsForNB()">
                    <option value="Ampicillin"    >Ampicillin   </option>
                    <option value="Gentamicin"    >Gentamicin   </option>
                    <option value="Cefotaxime"    >Cefotaxime   </option>
                    <option value="Ceftazidime"   >Ceftazidime  </option>
                    <option value="Vancomycin"    >Vancomycin   </option>
                    <option value="Meropenem"     >Meropenem    </option>
                    <option value="Metronidazole" >Metronidazole</option>
                    <option value="Amikacin"      >Amikacin</option>
                    <option value="Cefazolin"     >Cefazolin</option>
                    <option value="Oxacillin"     >Oxacillin</option>
                    <option value="Tazocin"       >Tazocin</option>
                    <option value="Augmentin"     >Augmentin</option>
                    <!-- <option value="Teicoplanin"   >Teicoplanin</option> -->
                    <!-- More options -->
                  </select>
                  <span class="input-group-text justify-content-center" style="width: 15%;" id="drug_extract_amount_unit"> </span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;" id="drug_extract_amount_unit">GA</span>
                  <input type="text" id="anti_NB_gestational_age_week" class="form-control text-center" oninput="calculateAntibioticsForNB()" />
                  <span class="input-group-text justify-content-center" id="drug_extract_amount_unit">week</span>
                  <input type="text" id="anti_NB_gestational_age_day" class="form-control text-center" oninput="calculateAntibioticsForNB()" />
                  <span class="input-group-text justify-content-center" style="width: 15%;" >day</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Birthday</span>
                  <input type="date" id="anti_NB_birthday" class="form-control text-center" oninput="calculateAntibioticsForNB()" value=/>
                  <span class="input-group-text justify-content-center" style="width: 15%;" id="drug_extract_amount_unit"> </span>
                </div>
              </div>
              <div class="card-footer">
                <div class="row">
                  <div class="col-10">
                    <div class="input-group flex-nowrap">
                      <span class="input-group-text justify-content-center" style="min-width: 15%;">Standard</span>
                      <span class="input-group-text justify-content-center text-truncate" style="width: 20%;" id="anti_NB_standard_dose_text"></span>
                      <span class="input-group-text text-truncate copy-item" style="width: 65%;" id="anti_NB_standard_dose_description_text"></span>
                    </div>
                    <div class="input-group flex-nowrap">
                      <span class="input-group-text justify-content-center" style="min-width: 15%;">Meningitis</span>
                      <span class="input-group-text justify-content-center text-truncate" style="width: 20%;" id="anti_NB_meningitis_dose_text"></span>
                      <span class="input-group-text text-truncate copy-item" style="width: 65%;" id="anti_NB_meningitis_dose_description_text"></span>
                    </div>
                    <div class="input-group">
                      <span class="input-group-text justify-content-center" style="width: 15%;">Remark</span>
                      <span class="input-group-text flex-fill text-truncate" id="anti_NB_dose_remark"></span>
                    </div>
                  </div>
                  <div class="col-2" style="padding-left: 0%;">
                    <div class="d-flex justify-content-center align-items-center h-100">
                      <button class="btn btn-secondary" onclick="resetForm('anti_NB_content')">Reset</button>
                    </div>    
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- <div class="row mb-3">
          <div class="col">
            <div class="card h-100">
              <div class="card-header text-center">ICD-10 搜尋</div>
              <div class="card-body">
                <div class="input-group mb-3">
                  <input type="text" id="icd10SearchInput" class="form-control" placeholder="輸入 ICD-10 代碼或關鍵字...">
                  <button class="btn btn-dark" onclick="searchICD10()">搜尋</button>
                </div>
                <ul id="icd10Results" class="list-group"></ul>
              </div>
            </div>
            </div>
          </div>
        </div> -->
        
      </div>
    </div>

    <!-- 分頁 3: 生長測量 -->
    <div class="tab-pane" id="growthContent" role="tabpanel" aria-labelledby="medicationTab">
      <div class="container mt-4">
        <div class="row mb-3">
          <div class="col">
            <div class="card h-100" id="growth_content">
              <div class="card-header text-center">生長測量 (開發中)</div>
              <div class="card-body pb-0">
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">GA</span>
                  <input type="number" id="growth_GA_week" class="form-control text-center" oninput="calculateGrowthIndex()" />
                  <span class="input-group-text justify-content-center">weeks</span>
                  <input type="number" id="growth_GA_day" class="form-control text-center" oninput="calculateGrowthIndex()" />
                  <span class="input-group-text justify-content-center" style="width: 15%;">days</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">Sex</span>
                  <select id="growth_gender" class="form-select text-center" title="" onchange="calculateGrowthIndex()">
                    <option value=""></option>
                    <option value="Boy">Boy</option>
                    <option value="Girl">Girl</option>
                  </select>
                  <span class="input-group-text justify-content-center" style="width: 15%;"></span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">體重</span>
                  <input type="number" id="growth_BBW" class="form-control text-center" oninput="calculateGrowthIndex()" />
                  <span class="input-group-text justify-content-center" style="width: 15%;">g</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">身長</span>
                  <input type="number" id="growth_BBL" class="form-control text-center" oninput="calculateGrowthIndex()" />
                  <span class="input-group-text justify-content-center" style="width: 15%;">cm</span>
                </div>
                <div class="input-group">
                  <span class="input-group-text justify-content-center" style="width: 15%;">頭圍</span>
                  <input type="number" id="growth_BHC" class="form-control text-center" oninput="calculateGrowthIndex()" />
                  <span class="input-group-text justify-content-center" style="width: 15%;">cm</span>
                </div>
              </div>
              <div class="card-footer">
                <div class="row">
                  <div class="col-10">
                    <ul class="list-group mt-2 mb-2">
                      <li class="list-group-item copy-item" id="growth_output">
                        GA:<br>Gender:<br>BBW:<br>BBL:<br>BHC:<br>Ponderal index:
                      </li>
                    </ul>
                  </div>
                  <div class="col-2" style="padding-left: 0%;">
                    <div class="d-flex justify-content-center align-items-center h-100">
                      <button class="btn btn-secondary" onclick="resetForm('growth_content')">Reset</button>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <p> 本網站使用的生長曲線數據參數由 Dr.Fenton 提供，特此感謝。 (Creative Commons license) <br> Fenton TR, Kim JH. A systematic review and meta-analysis to revise the Fenton growth chart for preterm infants. BMC Pediatr. 2013;13:59. </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- 其他分頁內容保持不變 -->
    <!-- ... -->
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.0.0/math.min.js"></script>
  <!-- Intro.js JS -->
  <script src="https://cdn.jsdelivr.net/npm/intro.js/minified/intro.min.js"></script>

  <script>
    //*****************************************
    // 計算水分
    //*****************************************
    function calculateFluid() {

      //設定SMOF密度
      const fluidLipidSpec = {
        "SMOF": {density: 1/5, unit: "g/ml"},
        "Omegaven": {density: 1/10, unit: "g/ml"}
      };

      //設定TPN配方說明
      const fluidTpnAAMap = {
        "0.025": "TPN",
        "0.030": "TPN [AA 3.0]",
        "0.033": "TPN [AA 3.3]",
        "0.035": "TPN [AA 3.5]",
        "0.040": "TPN [AA 4.0]",
        "0.050": "TPN [N0]"
      };

      //讀取輸入值
      const fluidBW = parseFloat(document.getElementById('fluid_BW').value) || 0;
      const fluidTDF = parseFloat(document.getElementById('fluid_TDF').value) || 0;
      const fluidPO = document.getElementById('fluid_PO').value;
      const fluidPOHM = document.getElementById('fluid_PO_HM').value;
      const fluidPOFormula = document.getElementById('fluid_PO_formula').value;
      const fluidTPNAA = document.getElementById('fluid_TPN_AA').value;
      let fluidTPNGrams = document.getElementById('fluid_TPN_grams').value;
      const fluidTPNHours = parseFloat(document.getElementById('fluid_TPN_hours').value) || 24;
      const fluidLipidType = document.getElementById('fluid_lipid_type').value;
      const fluidLipidGrams = parseFloat(document.getElementById('fluid_lipid_grams').value) || 0;
      const fluidLipidHours = parseFloat(document.getElementById('fluid_lipid_hours').value) || 20;
      let fluidOtherInIO = document.querySelectorAll('[name="fluid_other_in_IO"]');
      let fluidOtherSolutionRate = document.querySelectorAll('[name="fluid_other_solution_rate"]');
      const fluidRegularIVType = document.getElementById('fluid_regular_IV_type').value || "普通IV";
      let fluidRegularIVRate = parseFloat(document.getElementById('fluid_regular_IV_rate').value) || 0;
      
      //讀取進階版的元素的值
      let fluidTPNDex;
      let fluidTPNNa;
      let fluidTPNK;
      let fluidTPNCa;
      let fluidTPNP;
      let fluidTPNMg;
      let fluidOtherInIOBase=[""];
      let fluidOtherSolutionBase=[""];
      let fluidTotalGIR = 0;
      let fluidTotalNa = 0;
      let fluidTotalK  = 0;
      let fluidTotalCa = 0;
      let fluidTotalP  = 0;
      let fluidTotalMg = 0;
      if(fluidVersion === 'advanced'){
        fluidTPNDex = parseFloat(document.getElementById('fluid_TPN_dex').value) || 10;
        fluidTPNNa = parseFloat(document.getElementById('fluid_TPN_Na').value) || 40;
        fluidTPNK = parseFloat(document.getElementById('fluid_TPN_K').value) || 20;
        fluidTPNCa = parseFloat(document.getElementById('fluid_TPN_Ca').value) || 20;
        fluidTPNP = parseFloat(document.getElementById('fluid_TPN_P').value) || 9;
        fluidTPNMg = parseFloat(document.getElementById('fluid_TPN_Mg').value) || 2;
        fluidOtherInIOBase = document.querySelectorAll('[name="fluid_other_in_IO_base"]');
        fluidOtherSolutionBase = document.querySelectorAll('[name="fluid_other_solution_base"]');
      }

      // Only one of fluidTPNGrams and fluidRegularIVRate can be entered
      const fluidRegularIVRateDIV = document.getElementById('fluid_regular_IV_rate');
      const fluidTPNGramsDIV = document.getElementById('fluid_TPN_grams');
      fluidRegularIVRateDIV.disabled = fluidTPNGramsDIV.value !== "";
      fluidTPNGramsDIV.disabled = fluidRegularIVRateDIV.value !== "";

      // *****************************************
      // 歸零GIR, 離子統計
      // *****************************************
      //先將name=fluid_order_outputs都移除
      let fluidOrderOutputs = document.querySelectorAll('[name="fluid_order_outputs"]');
      fluidOrderOutputs.forEach(output => {
        output.remove();
      });      
      
      if (fluidVersion === 'advanced'){
        document.getElementById('fluid_nutrition_GIR').textContent = `GIR ___`;
        document.getElementById('fluid_nutrition_Na').textContent = `Na ___`;
        document.getElementById('fluid_nutrition_K').textContent = `K ___`;
        document.getElementById('fluid_nutrition_Ca').textContent = `Ca ___`;
        document.getElementById('fluid_nutrition_P').textContent = `P ___`;
        document.getElementById('fluid_nutrition_Mg').textContent = `Mg ___`;
      }

      // *****************************************
      //               計算fluid過程
      // *****************************************
      console.log("***************開始水分計算***************")
      console.log(`BW: ${fluidBW} g`);
      //計算TDF總量
      let fluidTotalTDF = (fluidTDF*fluidBW/1000).toFixed(1);
      console.log(`Total daily fluid: ${fluidTDF} ml/kg/day = total ${fluidTotalTDF} ml/day`);
      //計算PO總量
      let fluidTotalPO = fluidPO === "" ? 0 : parseExpression(fluidPO);      
      console.log(`Diet: ${fluidTotalPO} ml/day`);
      //計算Lipid總量
      let fluidLipidTotalVolumeGoal = fluidLipidGrams*fluidBW/1000/fluidLipidSpec[fluidLipidType].density;
      let fluidLipidValidHours = Math.min(23, Math.max(16, fluidLipidHours)); //確保輸入值在16~23之間
      let fluidLipidRate = (fluidLipidTotalVolumeGoal/fluidLipidValidHours).toFixed(1)
      let fluidLipidTotalVolume = fluidLipidRate*fluidLipidValidHours;
      let fluidLipidMinDiff = Math.abs(fluidLipidTotalVolume-fluidLipidTotalVolumeGoal);
      let fluidLipidBestHour = fluidLipidValidHours;
      const fluidLipidAcceptedError = 0.5;
      const fluidLipidMaxHour = 23;
      for (let i=16; i<=fluidLipidValidHours && i<=fluidLipidMaxHour; i++){
        fluidLipidRate = (fluidLipidTotalVolumeGoal/i).toFixed(1);
        fluidLipidTotalVolume = fluidLipidRate*i;
        const fluidLipidTotalVolumeDiff = Math.abs(fluidLipidTotalVolume-fluidLipidTotalVolumeGoal);
        if (fluidLipidTotalVolumeDiff<fluidLipidMinDiff || fluidLipidTotalVolumeDiff < fluidLipidAcceptedError){
          fluidLipidMinDiff=fluidLipidTotalVolumeDiff;
          fluidLipidBestHour=i;
        }
        // console.log(`target ${fluidLipidTotalVolumeGoal}, current ${fluidLipidTotalVolume}, current hr ${i}`);
        // console.log(`minDiff ${fluidLipidMinDiff.toFixed(1)}, bestHour = ${fluidLipidBestHour}`);
      }
      fluidLipidRate = (fluidLipidGrams*fluidBW/1000/fluidLipidSpec[fluidLipidType].density/fluidLipidBestHour).toFixed(1); //由best hour還原速率
      fluidLipidTotalVolume = fluidLipidRate*fluidLipidBestHour; //由best hour還原總量
      

      //計算fluid other in I/O 總量
      let fluidOtherInIOTotalVolume = 0;
      for (let i = 0; i < fluidOtherInIO.length; i++) {
        let eachVolume = parseExpression(fluidOtherInIO[i].value) || 0;
        //算總量
        fluidOtherInIOTotalVolume += eachVolume;
        // base value 用於計算Na intake
        if (fluidVersion === 'advanced') {
          let baseValue = fluidOtherInIOBase[i].value;
          if (baseValue === "3% NaCl") { fluidTotalNa += eachVolume*77/1000;} // 3% NaCl 1000ml = 77mEq Na
        }
      }
      console.log(`Other in I/O: ${fluidOtherInIOTotalVolume} ml/day`);

      //計算fluid Other Solution總量
      let fluidOtherSolutionTotalVolume = 0;
      for (let i = 0; i < fluidOtherSolutionRate.length; i++) {
        //先算總量
        let rateValue = parseExpression(fluidOtherSolutionRate[i].value) || 0;
        fluidOtherSolutionTotalVolume += rateValue*24;
        //再算成分
        if (fluidVersion === 'advanced') {
          let baseValue = fluidOtherSolutionBase[i].value;
          if      (baseValue === "L/R" ) { fluidTotalNa += rateValue*24/1000*130; } // L/R 1000ml = 130mEq Na
          else if (baseValue === "H/S" ) { fluidTotalNa += rateValue*24/1000*77 ; } // H/S 1000ml = 77mEq Na
          else if (baseValue === "N/S" ) { fluidTotalNa += rateValue*24/1000*154; } // N/S 1000ml = 154mEq Na
          else if (baseValue === "D/W" ) { }
          else if (baseValue === "D5W" ) { fluidTotalGIR += rateValue*5;}
          else if (baseValue === "D10W") { fluidTotalGIR += rateValue*10;}
        }
      }
      console.log(`Total Other Solution: ${fluidOtherSolutionTotalVolume} ml/day`);
      
      //計算fluid Regular IV and TPN
      let fluidTPNRate = 0;
      let fluidTPNTotalVolume = 0;
      let fluidRegularIVTotalVolume = 0;
      let fluidTPNMakeUp = "";

      //fluidTPNGrams有值，表示非補不足，先計算TPN再計算普通IV流速
      if (fluidTPNGrams || fluidTPNGrams === 0){ 
        fluidTPNGrams = fluidTPNGrams || 0;
        fluidTPNRate = (fluidTPNGrams*fluidBW/1000/fluidTPNAA/fluidTPNHours).toFixed(1);
        fluidTPNTotalVolume = fluidTPNRate*fluidTPNHours;

        //計算普通IV流速
        fluidRegularIVRate = ((fluidTotalTDF-fluidTotalPO-fluidTPNTotalVolume-fluidLipidTotalVolume-fluidOtherInIOTotalVolume-fluidOtherSolutionTotalVolume)/24).toFixed(1);
        fluidRegularIVTotalVolume = fluidRegularIVRate*24;
      } else { 
        //未設定tpn gram數，表示補不足，先計算普通IV流速再計算TPN
        fluidRegularIVTotalVolume = (fluidRegularIVRate*24).toFixed(1);
        fluidTPNTotalVolume = fluidTotalTDF-fluidTotalPO-fluidLipidTotalVolume-fluidOtherInIOTotalVolume-fluidOtherSolutionTotalVolume-fluidRegularIVTotalVolume;
        fluidTPNRate = (fluidTPNTotalVolume/fluidTPNHours).toFixed(1);
        fluidTPNGrams = (fluidTPNRate*fluidTPNHours*fluidTPNAA/(fluidBW/1000)).toFixed(2);
        fluidTPNMakeUp = " (補)";
      }
      console.log(`Regular IV: ${fluidRegularIVRate} ml/hr`);
      console.log(`TPN ${fluidTPNGrams} g/kg/day = ${fluidTPNRate} ml/hr run ${fluidTPNHours} hrs`);
      console.log("***************結束水分計算***************")
                   
      // *****************************************
      //           將計算結果轉成文字輸出
      // *****************************************
      console.log("***************開始文字輸出***************")
      let fluidOrderArray = [];
      // BW: ? g
      let fluidOrderOutputBW = fluidBW === 0 ? "BW:" : `BW: ${fluidBW} g`;
      fluidOrderArray.push(fluidOrderOutputBW);
      console.log(`BW: ${fluidOrderOutputBW}`);

      // TDF: ? ml/kg/day = total ? ml/day
      let fluidOrderOutputTDF = fluidTDF === 0 ? "Total daily fluid:" : `Total daily fluid: ${fluidTDF} ml/kg/day = total ${fluidTotalTDF} ml/day`;
      fluidOrderArray.push(fluidOrderOutputTDF);
      console.log(`Total daily fluid: ${fluidOrderOutputTDF}`);

      // PO: Diet: ? ml/day
      let fluidOrderOutputPO = "";
      const fluidPOPattern = /^(\d+\s*\*\s*\d+)(\s*\+\s*\d+\s*\*\s*\d+)*$/; // "A*B + C*D + E*F ...", where A B ... are numbers  
      if (fluidPO == "") { fluidOrderOutputPO = "";} 
      else if (fluidPO === 0) { fluidOrderOutputPO = "Diet: NPO with OG decompression";} //若輸入為0則NPO
      else if (!fluidPOPattern.test(fluidPO)) { console.log("Invalid PO format"); fluidOrderOutputPO = `Diet: ${fluidTotalPO} ml/day`;}
      else {

        //抓出PO裡面的數字組合 A*B + C*D + E*F ... 
        const fluidPOComponentsPattern = /(\d+)\s*\*\s*(\d+)/g; // match all A*B, where A B are numbers
        let fluidPOComponentsMatch;
        let fluidPOComponentsPairs = [];
        while ((fluidPOComponentsMatch = fluidPOComponentsPattern.exec(fluidPO)) !== null) {
          const [_, base, multiplier] = fluidPOComponentsMatch;
          fluidPOComponentsPairs.push({ base: parseInt(base), multiplier: parseInt(multiplier) });
        }
        
        // 計算總共幾餐 = Q?H feeding, ? = 24/總餐數
        let fluidPOMultiplierSum = fluidPOComponentsPairs.reduce((sum, item) => sum + item.multiplier, 0);
        if (24 % fluidPOMultiplierSum !== 0) { fluidOrderOutputPO = `Diet: ${fluidTotalPO} ml/day`; } //若不能整除24則直接輸出總量
        else{
          fluidOrderOutputPO = fluidPOComponentsPairs.map(({ base, multiplier }) => `${base}ml * ${multiplier} meals`).join(" then ");
          fluidOrderOutputPO.split(" then ").slice(0, -1).join(" then "); //移除最後一個元素 (最後一個*幾餐)
          fluidOrderOutputPO += ` / Q${24/fluidPOMultiplierSum}H`;  //加上餵食頻率
          // 加上奶品
          let fluidPOMilkType = fluidPOHM && fluidPOFormula ?  `${fluidPOHM}/${fluidPOFormula}` : fluidPOHM || fluidPOFormula || '';
          fluidOrderOutputPO = fluidPOMilkType ? `${fluidPOMilkType} ${fluidOrderOutputPO}` : fluidOrderOutputPO;
          // 加上PO總量
          fluidOrderOutputPO = `Diet: ${fluidOrderOutputPO} = (total ${fluidTotalPO}ml/day )`;
        }
      }
      fluidOrderArray.push(fluidOrderOutputPO);
      console.log(`Diet: ${fluidOrderOutputPO}`);     

      // TPN: ? g/kg/day = ? ml/hr run ? hrs
      let fluidOrderOutputTPNHours = fluidTPNHours ===24? "":`run ${fluidTPNHours}hrs`;
      let fluidOrderOutputTPN = `${fluidTpnAAMap[fluidTPNAA]}${fluidTPNMakeUp} ${fluidTPNGrams}g/kg/day=${fluidTPNRate}ml/hr ${fluidOrderOutputTPNHours}`;
      fluidOrderOutputTPN = fluidTPNGrams==0 ? "":fluidOrderOutputTPN;
      fluidOrderOutputTPN = fluidBW > 0 ? fluidOrderOutputTPN : ""; //若BW=0則不顯示TPN，避免出現NaN
      fluidOrderArray.push(fluidOrderOutputTPN);
      console.log(`TPN: ${fluidOrderOutputTPN}`);      

      // Lipid: ? g/kg/day = total ? g/day
      let fluidOrderOutputLipid = `${fluidLipidType} ${fluidLipidGrams}g/kg/day = ${fluidLipidRate} ml/hr run ${fluidLipidBestHour} hrs`;
      fluidOrderOutputLipid = fluidLipidGrams==0 ? "":fluidOrderOutputLipid;
      fluidOrderArray.push(fluidOrderOutputLipid);
      console.log(`Lipid: ${fluidOrderOutputLipid}`); 

      // Other in I/O: ? ml/day
      let fluidOrderOutputOtherInIO = fluidOtherInIOTotalVolume === 0 ? "" : `Other in I/O: ${fluidOtherInIOTotalVolume} ml/day`;
      fluidOrderArray.push(fluidOrderOutputOtherInIO);
      console.log(`Other in I/O: ${fluidOrderOutputOtherInIO} ml/day`);

      // other solution: ? ml/hr
      let fluidOrderOutputOtherSolution = fluidOtherSolutionTotalVolume === 0 ? "" : `Total Other Solution run ${(fluidOtherSolutionTotalVolume/24).toFixed(1)} ml/hr = ${fluidOtherSolutionTotalVolume.toFixed(1)} ml/day`;
      fluidOrderArray.push(fluidOrderOutputOtherSolution);
      console.log(`Total Other Solution: ${fluidOrderOutputOtherSolution}`);

      // Regular IV: ? ml/hr
      let fluidOrderOutputRegularIV = fluidRegularIVRate === 0 ? "" : `${fluidRegularIVType} run ${fluidRegularIVRate} ml/hr`;
      fluidOrderArray.push(fluidOrderOutputRegularIV);
      console.log(`Regular IV: ${fluidRegularIVRate} ml/hr`);

      console.log("***************結束文字輸出***************")
      console.log(fluidOrderArray.join("\n"));

      // *****************************************
      //           計算營養成分
      // *****************************************

      //計算GIR
      //let fluidGIR = 0;

      //已計算other in I/O離子
      //已計算other solution離子

      //計算TPN離子, GIR
      fluidTotalGIR+= fluidTPNRate*fluidTPNDex;
      fluidTotalNa += fluidTPNTotalVolume/1000*fluidTPNNa;
      fluidTotalK  += fluidTPNTotalVolume/1000*fluidTPNK;
      fluidTotalCa += fluidTPNTotalVolume/1000*fluidTPNCa;
      fluidTotalP  += fluidTPNTotalVolume/1000*fluidTPNP;
      fluidTotalMg += fluidTPNTotalVolume/1000*fluidTPNMg;

      //計算regular IV離子, GIR
      switch (fluidRegularIVType) {
        case 'D0.225S(500)'           : {
          fluidTotalNa += fluidRegularIVTotalVolume/1000*38.5; // D0.225S(500) 1000ml = 38.5mEq Na
          fluidTotalGIR += fluidRegularIVRate*5;
          break;
        } 
        case 'D0.225S(500) + 2PC D50W': {
          fluidTotalNa += fluidRegularIVTotalVolume/1000*38.5; // D0.225S(500) 1000ml = 38.5mEq Na
          fluidTotalGIR += fluidRegularIVRate*8.33;
          break;
        } 
        case 'Dex 2.5% in 0.45 Saline': {
          fluidTotalNa += fluidRegularIVTotalVolume/1000*77; // H/S 1000ml = 77 mEq Na
          fluidTotalGIR += fluidRegularIVRate*2.5;
          break;
        } 
        case 'D5W' : {fluidTotalGIR += fluidRegularIVRate*5; break;}
        case 'D10W': {fluidTotalGIR += fluidRegularIVRate*10; break;}
        case 'H/S' : {fluidTotalNa  += fluidRegularIVTotalVolume/1000*77;   break;} // H/S 1000ml = 77 mEq Na
        case 'N/S' : {fluidTotalNa  += fluidRegularIVTotalVolume/1000*154;  break;} // N/S 1000ml = 154 mEq Na; 
      }
      

      let fluidTotalNaPerKg = fluidBW > 0 ? (fluidTotalNa/(fluidBW/1000)).toFixed(1) : "___";
      let fluidTotalKPerKg  = fluidBW > 0 ? (fluidTotalK /(fluidBW/1000)).toFixed(1) : "___";
      let fluidTotalCaPerKg = fluidBW > 0 ? (fluidTotalCa/(fluidBW/1000)).toFixed(1) : "___";
      let fluidTotalPPerKg  = fluidBW > 0 ? (fluidTotalP /(fluidBW/1000)).toFixed(1) : "___";
      let fluidTotalMgPerKg = fluidBW > 0 ? (fluidTotalMg/(fluidBW/1000)).toFixed(1) : "___";
      

      //計算GIR
      fluidTotalGIR = fluidBW > 0 ? (fluidTotalGIR/(6*fluidBW/1000)).toFixed(2) : "___";

      // *****************************************
      //           將計算結果輸出到網頁
      // *****************************************
      
      //在fluid_order_output下面新增一個節點，顯示計算結果
      // let fluidOrderOutputDiv = document.getElementById('fluid_order_output');
      // fluidOrderArray.forEach(order => {
      //   if (order) {
      //     fluidOrderOutputDiv.insertAdjacentHTML('afterend', `<li class="list-group-item copy-item" name="fluid_order_outputs">${order}</li>`);
      //     fluidOrderOutputDiv=fluidOrderOutputDiv.nextSibling; //移動到下一個節點
      //   }
      // });

      //在fluid_order_output下append一個節點，顯示計算結果
      let fluidOrderOutputDiv = document.getElementById('fluid_order_output');
      fluidOrderArray.forEach(order => {
        if (order) {
          // 創建新的 li 元素
          const listItem = document.createElement('li');
          listItem.className = 'list-group-item copy-item';
          listItem.setAttribute('name', 'fluid_order_outputs');
          listItem.textContent = order; // 設定 li 的內容

          // 將 li 元素附加到指定的 div 底下
          fluidOrderOutputDiv.appendChild(listItem);
        }
      });


      if (fluidVersion === 'advanced'){
        //將GIR ?, Na ? mEq, K ? mmol, Ca ? mEq, P ? mmol, Mg mEq 輸出到網頁
        document.getElementById('fluid_nutrition_GIR').textContent = `GIR ${fluidTotalGIR}`;
        document.getElementById('fluid_nutrition_Na').textContent = `Na ${fluidTotalNaPerKg}`;
        document.getElementById('fluid_nutrition_K').textContent = `K ${fluidTotalKPerKg}`;
        document.getElementById('fluid_nutrition_Ca').textContent = `Ca ${fluidTotalCaPerKg}`;
        document.getElementById('fluid_nutrition_P').textContent = `P ${fluidTotalPPerKg}`;
        document.getElementById('fluid_nutrition_Mg').textContent = `Mg ${fluidTotalMgPerKg}`;
      }

      //把新增的結果加上複製功能
      addCopyEventListener();
    }

    
    // *****************************************
    // 切換基礎進階版
    // *****************************************

    let removedElements = []; // 用於存儲被刪除的元素及其位置
    let fluidVersion = 'basic'; // 預設為基礎版
    function fluidVersionToggle(version) {
      switch (version) {
        case 'basic':
          fluidVersion = version; // 更新 fluidVersion
          // 找到所有帶有 class="advanced-version-only" 的元素
          const advancedVersionOnly = document.querySelectorAll('.advanced-version-only');

          // 記錄元素的父節點和索引，然後刪除
          advancedVersionOnly.forEach(element => {
            const parent = element.parentNode; // 父節點
            const index = Array.from(parent.children).indexOf(element); // 索引位置
            removedElements.push({ element, parent, index }); // 保存資訊
            element.remove(); // 刪除元素
          });
          break;

        case 'advanced':
          fluidVersion = version; // 更新 fluidVersion
          // 將儲存的元素加回到原本的位置
          removedElements.forEach(item => {
            const { element, parent, index } = item;
            if (parent.children[index]) {
              parent.insertBefore(element, parent.children[index]); // 插回指定索引位置
            } else {
              parent.appendChild(element); // 如果是最後一個，直接追加到父節點
            }
          });
          removedElements = []; // 清空記錄
          break;
      }

      calculateFluid(); // 重新計算

    }


    // *****************************************
    // 計算機
    // *****************************************
    function fluidCalclator(){
      const calc = document.getElementById('fluid_calc').value;
      document.getElementById('fluid_calc_result').textContent = parseExpression(calc) || "";
      return;
    }

    
    // ***************************************
    // Intro 導入教學
    // ***************************************
    function fluidIntro(){
      //輸入範例
      const exampleInputs = {
        fluid_BW: 1500,
        fluid_TDF: 150,
        fluid_PO: '5*2+10*4',
        fluid_TPN_hours: 22.5,
        fluid_lipid_grams: 2,
        fluid_other_in_IO_default: '2*3+5',
        fluid_other_solution_rate_default: '0.2+0.5',
      };
      Object.keys(exampleInputs).forEach(key => {
        document.getElementById(key).value = exampleInputs[key];
      });
      
      //範例結果
      calculateFluid();
      
      let steps = [
        { element: "#fluid_BW_area", intro: "輸入體重" },
        { element: "#fluid_TDF_area", intro: "輸入所需總水分" },
        { element: "#fluid_PO_area", intro: "輸入奶量時可直接輸入總量或算式" },
        { element: "#fluid_TPN_area", intro: "<1>若TPN補不足，則留空<br><2>輸入小時可限制輸注時間" },
        { element: "#fluid_TPN_content_area", intro: "可調整TPN成分<br>以計算各成分每日攝取量" },
        { element: "#fluid_lipid_area", intro: "輸注時間留空會自動計算最佳時間<br>(Lipid 需 >= 16 hours)" },
        { element: "#fluid_other_in_IO_area", intro: "<1>這裡是其他要計入水分的量<br>(可輸入總量或算式)<br><2>最尾端的+號按鈕可新增一欄" },
        { element: "#fluid_other_solution_area", intro: "<1>這裡是其他要計入的藥物流速<br>(可輸入總量或算式)<br><2>最尾端的+號按鈕可新增一欄" },
        { element: "#fluid_nutrition_area", intro: "這裡會顯示GIR及各成分每日每公斤攝取量的計算結果<br>(包括TPN+other+普通IV)"},
        { element: "#fluid_order_output", intro: "最後，這裡會顯示結果<br>按一下即可複製！" }
      ];

      // 如果是基礎版，刪除進階版(#fluid_TPN_content_area", "#fluid_nutrition_area)相關的步驟
      if (fluidVersion === 'basic') {
        steps = steps.filter(step => !["#fluid_TPN_content_area", "#fluid_nutrition_area"].includes(step.element));
      }

      //設定intro
      const intro = introJs();
      intro.setOptions({
        steps: steps,
        showProgress: true,  // 顯示進度條
        showBullets: false,  // 移除底部圓點
        disableInteraction: false,  // 可以點擊其他區塊
        exitOnOverlayClick: false,  // 點擊外部不會結束教學
        scrollToElement: true,  // 自動滾動到教學元素
      })
      
      intro.oncomplete( function() {resetForm('fluid_content');} );
      intro.onexit( function() {resetForm('fluid_content');} );     
      intro.start(); 
    }


    // *****************************************
    // 計算GIR
    // *****************************************
    function calculateGIR(){
      //讀取輸入值
      const girBW = parseFloat(document.getElementById('GIR_BW').value) || 0;
      let girDex = document.querySelectorAll('[name="GIR_dex"]');
      let girRate = document.querySelectorAll('[name="GIR_rate"]');
      let girTotal = 0;
      for (let i = 0; i < girDex.length; i++) {
        let dex = parseFloat(girDex[i].value) || 0;
        let rate = parseFloat(girRate[i].value) || 0;
        girTotal += dex*rate;
      }

      girTotal = girTotal/(6*girBW/1000);

      //將GIR輸出到網頁
      document.getElementById('GIR_result').textContent = girTotal? `GIR ${girTotal.toFixed(2)}`:"GIR 0.0";
    }


    // *****************************************
    // 計算Dextrose濃度
    // *****************************************
    function calculateDex(){
      //讀取輸入值
      const dextroseOriginalConcentration = parseFloat(document.getElementById('dextrose_original_concentration').value) || 0;
      const dextroseOriginalAmount = parseFloat(document.getElementById('dextrose_original_amount').value) || 0;
      const dextroseAddConcentration = parseFloat(document.getElementById('dextrose_add_concentration').value) || 0;
      const dextroseAddAmount = parseFloat(document.getElementById('dextrose_add_amount').value) || 0;

      let dextroseConcentrationFinal = (dextroseOriginalConcentration/100*dextroseOriginalAmount + dextroseAddConcentration/100*dextroseAddAmount)/(dextroseOriginalAmount+dextroseAddAmount)*100;
      dextroseConcentrationFinal = dextroseConcentrationFinal > 0 ? dextroseConcentrationFinal.toFixed(2) : 0.00;

      
      //將Dextrose濃度輸出到網頁
      document.getElementById('dextrose_concentration_final').textContent = `Dextrose = ${dextroseConcentrationFinal} %`;
    }


    // *****************************************
    // 計算UA、UV深度
    // *****************************************
    function calculateUmbilicalCathLen(){
      //讀取輸入值
      const umbilicalCathLenBW = parseFloat(document.getElementById('umbilical_cath_len_BW').value) || 0;
      const umbilicalCathLenUAHigh = umbilicalCathLenBW > 0 ? (umbilicalCathLenBW/1000*3+9).toFixed(1) : "";
      const umbilicalCathLenUALow = umbilicalCathLenBW > 0 ? (umbilicalCathLenBW/1000+7).toFixed(1) : "";
      const umbilicalCathLenUV = umbilicalCathLenUAHigh > 0 ? (umbilicalCathLenUAHigh/2+1).toFixed(1) : "";
   
      //將UA、UV深度輸出到網頁
      document.getElementById('umbilical_cath_len_UA').textContent = umbilicalCathLenUAHigh? `高位 ${umbilicalCathLenUAHigh} cm, 低位 ${umbilicalCathLenUALow} cm`:"";
      document.getElementById('umbilical_cath_len_UV').textContent = umbilicalCathLenUV? `${umbilicalCathLenUV} cm`:"";
    }


    // *****************************************
    // 設定藥物資料
    // *****************************************
    const drugSpecs = {
      'Dopamine'      : { concentration: 40     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Dobutamine'    : { concentration: 12.5   , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Milrinone'     : { concentration: 1      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Epinephrine'   : { concentration: 1      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2},
      'Midazolam'     : { concentration: 5      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Fentanyl'      : { concentration: 0.05   , unit: 'mg/ml' , rateUnit: 'mcg/kg/hr'  , decimalPlace: 3},
      'Bumetanide'    : { concentration: 0.25   , unit: 'mg/ml' , rateUnit: 'mcg/kg/hr'  , decimalPlace: 1},
      'Norepinephrine': { concentration: 1      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2},
      'Nicardipine'   : { concentration: 1      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Nitroglycerin' : { concentration: 0.5    , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2}, //小數點待確定
      'Labetalol'     : { concentration: 5      , unit: 'mg/ml' , rateUnit: 'mg/kg/hr'   , decimalPlace: 2}, //小數點待確定
      'PGE1'          : { concentration: 0.5    , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2},
      'Vasopressin'   : { concentration: 20     , unit: 'U/ml'  , rateUnit: 'mU/kg/min'  , decimalPlace: 1},
      'Isoproterenol' : { concentration: 0.2    , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Rocuronium'    : { concentration: 10     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Cisatracurium' : { concentration: 2      , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Morphine'      : { concentration: 10     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2}, //小數點待確定
      'Lorazepam'     : { concentration: 2      , unit: 'mg/ml' , rateUnit: 'mg/kg/hr'   , decimalPlace: 2}, //小數點待確定
      'Ketamine'      : { concentration: 50     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 1},
      'Propofol'      : { concentration: 10     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2}, //小數點待確定
      'MgSO4'         : { concentration: 100    , unit: 'mg/ml' , rateUnit: 'mg/kg/hr'   , decimalPlace: 1},
      'Lidocaine'     : { concentration: 50     , unit: 'mg/ml' , rateUnit: 'mcg/kg/min' , decimalPlace: 2},  //小數點待確定
      'Insulin'       : { concentration: 100    , unit: 'U/ml'  , rateUnit: 'U/kg/hr'    , decimalPlace: 0}
    };

    // *****************************************
    // 計算藥物配製
    // *****************************************
    function calculateDrugPreperation() {
      //讀取輸入值
      const drugBW = parseFloat(document.getElementById('drug_BW').value) || 0;
      const drugName = document.getElementById('drug_name').value;
      let drugExtractAmount = parseFloat(document.getElementById('drug_extract_amount').value) || 0;
      const drugDiluterName = document.getElementById('drug_diluter_name').value;
      const drugTotalFinalVolume = parseFloat(document.getElementById('drug_total_final_volume').value) || 0;
      const drugInfusionRate = parseFloat(document.getElementById('drug_infusion_rate').value) || 0;
      let drugInfusionFinalRate = parseFloat(document.getElementById('drug_infusion_final_rate').value) || 0;

      //取得藥物資料
      const drugSpec = drugSpecs[drugName];

      //更新網頁上顯示的藥物濃度單位
      document.getElementById('drug_name').title= `${drugName} ${drugSpec.concentration} ${drugSpec.unit}`;
      document.getElementById('drug_extract_amount_unit').textContent = (drugSpec.unit).replace("/ml","");
      document.getElementById('drug_infusion_final_rate_unit').textContent = drugSpec.rateUnit;

      //限制網頁上的輸入框，若drugExtractAmount>0則drugInfusionFinalRate不能輸入，反之亦然，若都沒有值則都可以輸入
      document.getElementById('drug_infusion_final_rate').disabled = drugExtractAmount > 0;
      document.getElementById('drug_extract_amount').disabled = drugInfusionFinalRate > 0;

      //重量單位換算
      let drugUnitConversionRatio = 1;
      const drugExtractAmountUnits = (drugSpec.unit).split("/"); // e.g. [0] = mg, [1] = ml
      const drugInfusionFinalRateUnits = (drugSpec.rateUnit).split("/"); // e.g. [0] = mcg, [1] = kg, [2] = min
      const drugUnitComb = `${drugExtractAmountUnits[0]}-${drugInfusionFinalRateUnits[0]}`;
      switch (drugUnitComb) {
        case 'mg-mcg': drugUnitConversionRatio = 1/1000; break;
        case 'U-mU'  : drugUnitConversionRatio = 1/1000; break;
        case 'mg-mg' : drugUnitConversionRatio = 1; break;
        default: drugUnitConversionRatio = 1; break;
      }

      //時間單位換算
      let drugTimeConversionRatio = 1;
      if (drugInfusionFinalRateUnits[2] === 'min') drugTimeConversionRatio = 60; // e.g. [0] = mcg, [1] = kg, [2] = min
      
      //若無drugExtractAmount, 用drugInfusionFinalRate回推; 反之亦然
      if (drugExtractAmount === 0) {
        drugExtractAmount = drugInfusionFinalRate * drugBW * drugUnitConversionRatio * drugTimeConversionRatio / drugInfusionRate * drugTotalFinalVolume.toFixed(drugSpec.decimalPlace);
        // drugInfusionFinalRate = drugInfusionFinalRate.toFixed(2);
      } else {
        drugInfusionFinalRate = (drugExtractAmount / drugTotalFinalVolume / drugBW / drugUnitConversionRatio / drugTimeConversionRatio * drugInfusionRate).toFixed(2);
        drugExtractAmount = drugExtractAmount.toFixed(drugSpec.decimalPlace);
      }
      
      //計算需要多少dilutor
      let drugDiluterAmount = ( drugTotalFinalVolume - drugExtractAmount / drugSpec.concentration ).toFixed(1);

      //計算pure line
      let drugPureLineFinalRate = ( 1 * drugSpec.concentration / drugUnitConversionRatio / drugBW / drugTimeConversionRatio).toFixed(1);

      //輸出成文字
      let drugTextForOrder = `${drugName} ${drugExtractAmount}${drugExtractAmountUnits[0]} in ${drugDiluterName} ${drugDiluterAmount}ml (total ${drugTotalFinalVolume}ml), run ${drugInfusionRate}ml/hr = ${drugInfusionFinalRate} ${drugSpec.rateUnit}`;
      let drugTextForMed = `${drugName} ${drugExtractAmount}${drugExtractAmountUnits[0]} in ${drugDiluterName} ${drugDiluterAmount}ml (total ${drugTotalFinalVolume}ml), run as order`;
      let drugTextForPureLine = `${drugName} pure line 1 ml/hr = ${drugPureLineFinalRate} ${drugSpec.rateUnit}`;

      //輸出到網頁
      if (drugBW && drugName && drugDiluterName && drugTotalFinalVolume && drugInfusionRate && (drugExtractAmount||drugInfusionFinalRate)) {
        document.getElementById('drug_text_for_order').textContent = drugTextForOrder;
        document.getElementById('drug_text_for_med').textContent = drugTextForMed;
        document.getElementById('drug_text_for_pure_line').textContent = drugTextForPureLine;
      } else {
        document.getElementById('drug_text_for_order').textContent = "醫囑";
        document.getElementById('drug_text_for_med').textContent = "藥囑";
        document.getElementById('drug_text_for_pure_line').textContent = "Pure Line";
      }
    }    

    // *****************************************
    // 設定antibiotics資料
    // *****************************************
    const antiNBDrugSpecs = {
      'Ampicillin'    : { 
        'standard': [ 
          {GA_min: 0, GA_max: 34, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity        , frequency: "Q12H", dose: 50, unit: "mg/kg/dose", description: "50 mg/kg/dose, Q12H, dilute with diswater to 最終濃度100mg/ml, 所需量以IVF run 30 mins"},
          {GA_min: 0, GA_max: 34, PNA_min: 8, PNA_max: 28, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity       , frequency: "Q12H", dose: 75, unit: "mg/kg/dose", description: "75 mg/kg/dose, Q12H, dilute with diswater to 最終濃度100mg/ml, 所需量以IVF run 30 mins"},
          {GA_min: 35, GA_max: Infinity, PNA_min: 0, PNA_max: 28, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity, frequency: "Q8H", dose: 50, unit: "mg/kg/dose", description: "50 mg/kg/dose, Q8H, dilute with diswater to 最終濃度100mg/ml, 所需量以IVF run 30 mins"}
        ],
        'meningitis': [ 
          {GA_min: 0, GA_max: 34, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity        , frequency: "Q8H", dose: 100, unit: "mg/kg/dose", description: "100 mg/kg/dose, Q8H, dilute with diswater to 最終濃度100mg/ml, 所需量以IVF run 30 mins"},
          {GA_min: 0, GA_max: 34, PNA_min: 8, PNA_max:60, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity        , frequency: "Q6H", dose: 75, unit: "mg/kg/dose", description: "75 mg/kg/dose, Q6H, dilute with diswater to 最終濃度100mg/ml, 所需量以IVF run 30 mins"},
          {GA_min: 35, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity , frequency: "Q8H", dose: 100, unit: "mg/kg/dose", description: "100 mg/kg/dose, Q8H, dilute with diswater to 最終濃度100mg/ml, 所需量以IVF run 30 mins"},
          {GA_min: 35, GA_max: Infinity, PNA_min: 8, PNA_max: 60, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity, frequency: "Q6H", dose: 75, unit: "mg/kg/dose", description: "75 mg/kg/dose, Q6H, dilute with diswater to 最終濃度100mg/ml, 所需量以IVF run 30 mins"}
        ]      
      },
      'Gentamicin'    : {
        'standard': [ 
          {GA_min: 0, GA_max: 29, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity        , frequency: "Q48H", dose: 5, unit: "mg/kg/dose", description: "5 mg/kg/dose, Q48H, DILUTE WITH N/S TO 2ML RUN 30 MINS"},
          {GA_min: 0, GA_max: 29, PNA_min: 8, PNA_max: 28, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity       , frequency: "Q36H", dose: 4, unit: "mg/kg/dose", description: "4 mg/kg/dose, Q36H, DILUTE WITH N/S TO 2ML RUN 30 MINS"},
          {GA_min: 0, GA_max: 29, PNA_min: 29, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity, frequency: "Q24H", dose: 4, unit: "mg/kg/dose", description: "4 mg/kg/dose, Q24H, DILUTE WITH N/S TO 2ML RUN 30 MINS"},
          {GA_min: 30, GA_max: 34, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity       , frequency: "Q36H", dose: 4.5, unit: "mg/kg/dose", description: "4.5 mg/kg/dose, Q36H, DILUTE WITH N/S TO 2ML RUN 30 MINS"},
          {GA_min: 30, GA_max: 34, PNA_min: 8, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity, frequency: "Q24H", dose: 4, unit: "mg/kg/dose", description: "4 mg/kg/dose, Q24H, DILUTE WITH N/S TO 2ML RUN 30 MINS"},
          {GA_min: 35, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity , frequency: "Q24H", dose: 4, unit: "mg/kg/dose", description: "4 mg/kg/dose, Q24H, DILUTE WITH N/S TO 2ML RUN 30 MINS"}
        ]
      },
      'Cefotaxime'    : {
        'standard': [ 
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 50, unit: "mg/kg/dose", description: "50MG/KG/DOSE, Q12H, 用D/W泡成250MG/ML, DILUTED WITH N/S TO 2ML RUN 30 MINS"},
          {GA_min: 0, GA_max: 31, PNA_min: 8, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity , frequency: "Q8H", dose: 50, unit: "mg/kg/dose", description: "50MG/KG/DOSE, Q8H, 用D/W泡成250MG/ML, DILUTED WITH N/S TO 2ML RUN 30 MINS"},
          {GA_min: 32, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity , frequency: "Q6H", dose: 50, unit: "mg/kg/dose", description: "50MG/KG/DOSE, Q6H, 用D/W泡成250MG/ML, DILUTED WITH N/S TO 2ML RUN 30 MINS"}
        ],
        'meningitis':[
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 2000, BW_max: Infinity  , frequency: "Q8H", dose: 50, unit: "mg/kg/dose", description: "50MG/KG/DOSE, Q8H, 用D/W泡成250MG/ML, DILUTED WITH N/S TO 2ML RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 2000, BW_max: Infinity  , frequency: "Q6H", dose: 50, unit: "mg/kg/dose", description: "50MG/KG/DOSE, Q6H, 用D/W泡成250MG/ML, DILUTED WITH N/S TO 2ML RUN 30 MINS"}
        ]
      },
      'Ceftazidime'   : {
        'standard': [ 
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 28, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 30, unit: "mg/kg/dose", description: "30MG/KG/DOSE, Q12H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 29, PNA_max: Infinity, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 30, unit: "mg/kg/dose", description: "30MG/KG/DOSE, Q8H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 14, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 30, unit: "mg/kg/dose", description: "30MG/KG/DOSE, Q12H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 15, PNA_max: Infinity, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 30, unit: "mg/kg/dose", description: "30MG/KG/DOSE, Q8H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 30, unit: "mg/kg/dose", description: "30MG/KG/DOSE, Q12H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 30, unit: "mg/kg/dose", description: "30MG/KG/DOSE, Q8H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 45, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 30, unit: "mg/kg/dose", description: "30MG/KG/DOSE, Q8H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"}
        ],
        'meningitis': [ 
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: 1999  , frequency: "Q12H", dose: 50, unit: "mg/kg/dose", description: "50MG/KG/DOSE, Q12H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: Infinity, BW_min: 2000, BW_max: Infinity  , frequency: "Q8H", dose: 50, unit: "mg/kg/dose", description: "50MG/KG/DOSE, Q8H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 50, unit: "mg/kg/dose", description: "50MG/KG/DOSE, Q8H, 加5ML DISTILLED WATER, 泡成90MG/ML, DILUTE至最終濃度45mg/ml, RUN 30 MINS"}
        ]
      },
      'Vancomycin'    : {
        'standard': [ 
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 21, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q18H", dose: 15, unit: "mg/kg/dose", description: "15MG/KG/DOSE, Q18H, DILUTE WITH D/W TO 50MG/ML THEN DILUTE 10倍, RUN 1 HR"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 22, PNA_max: Infinity, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 15, unit: "mg/kg/dose", description: "15MG/KG/DOSE, Q12H, DILUTE WITH D/W TO 50MG/ML THEN DILUTE 10倍, RUN 1 HR"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 14, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 15, unit: "mg/kg/dose", description: "15MG/KG/DOSE, Q12H, DILUTE WITH D/W TO 50MG/ML THEN DILUTE 10倍, RUN 1 HR"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 15, PNA_max: Infinity, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 15, unit: "mg/kg/dose", description: "15MG/KG/DOSE, Q8H, DILUTE WITH D/W TO 50MG/ML THEN DILUTE 10倍, RUN 1 HR"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 15, unit: "mg/kg/dose", description: "15MG/KG/DOSE, Q12H, DILUTE WITH D/W TO 50MG/ML THEN DILUTE 10倍, RUN 1 HR"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 15, unit: "mg/kg/dose", description: "15MG/KG/DOSE, Q8H, DILUTE WITH D/W TO 50MG/ML THEN DILUTE 10倍, RUN 1 HR"},
          {GA_min: 0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 45, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q6H", dose: 15, unit: "mg/kg/dose", description: "15MG/KG/DOSE, Q6H, DILUTE WITH D/W TO 50MG/ML THEN DILUTE 10倍, RUN 1 HR"}
        ]
      },
      'Meropenem'     : {
        'standard': [ 
          {GA_min:  0, GA_max: 31, PNA_min: 0, PNA_max: 13, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 20, unit: "mg/kg/dose", description: "20mg/kg/dose, Q12H, 稀釋至50mg/ml, Dilute with N/S to 10倍, run 1 hr", remark: "嚴格限水時: Dilute with N/S to 2.5倍"},
          {GA_min:  0, GA_max: 31, PNA_min: 14, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 20, unit: "mg/kg/dose", description: "20mg/kg/dose, Q8H, 稀釋至50mg/ml, Dilute with N/S to 10倍, run 1 hr", remark: "嚴格限水時: Dilute with N/S to 2.5倍"},
          {GA_min: 32, GA_max: Infinity, PNA_min: 0, PNA_max: 13, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 20, unit: "mg/kg/dose", description: "20mg/kg/dose, Q8H, 稀釋至50mg/ml, Dilute with N/S to 10倍, run 1 hr", remark: "嚴格限水時: Dilute with N/S to 2.5倍"},
          {GA_min: 32, GA_max: Infinity, PNA_min: 14, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 30, unit: "mg/kg/dose", description: "30mg/kg/dose, Q8H, 稀釋至50mg/ml, Dilute with N/S to 10倍, run 1 hr", remark: "嚴格限水時: Dilute with N/S to 2.5倍"}
        ],
        'meningitis': [ 
          {GA_min:  0, GA_max: 31, PNA_min: 0, PNA_max: 13, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 40, unit: "mg/kg/dose", description: "40mg/kg/dose, Q12H, 稀釋至50mg/ml, Dilute with N/S to 10倍, run 1 hr", remark: "嚴格限水時: Dilute with N/S to 2.5倍"},
          {GA_min:  0, GA_max: 31, PNA_min: 14, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 40, unit: "mg/kg/dose", description: "40mg/kg/dose, Q8H, 稀釋至50mg/ml, Dilute with N/S to 10倍, run 1 hr", remark: "嚴格限水時: Dilute with N/S to 2.5倍"},
          {GA_min:  32, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 40, unit: "mg/kg/dose", description: "40mg/kg/dose, Q8H, 稀釋至50mg/ml, Dilute with N/S to 10倍, run 1 hr", remark: "嚴格限水時: Dilute with N/S to 2.5倍"}
        ]
      },
      'Metronidazole' : {
        'standard': [ 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 0, PMA_max: 33, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 7.5, unit: "mg/kg/dose", description: "maintenance 7.5 mg/kg/dose, Q12H, run 30 min", remark: "原液5mg/ml, 不須稀釋, 但需loading 15mg/kg"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 34, PMA_max: 40, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 7.5, unit: "mg/kg/dose", description: "maintenance 7.5 mg/kg/dose, Q8H, run 30 min", remark: "原液5mg/ml, 不須稀釋, 但需loading 15mg/kg"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 41, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q6H", dose: 7.5, unit: "mg/kg/dose", description: "maintenance 7.5 mg/kg/dose, Q6H, run 30 min", remark: "原液5mg/ml, 不須稀釋, 但需loading 15mg/kg. Maintain也可10mg/kg/dose Q8H."}, 
        ]
      },
      'Amikacin' :{
        'standard': [ 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 0, PMA_max: 28, BW_min: 0, BW_max: Infinity  , frequency: "Q48H", dose: 14, unit: "mg/kg/dose", description: "14mg/kg/dose, Q48H, dilute 50倍 run 1hr", remark: "可以D5W or N/S稀釋25~100倍至2.5~10mg/ml"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 8, PNA_max:28, PMA_min: 0, PMA_max: 28, BW_min: 0, BW_max: Infinity  , frequency: "Q36H", dose: 12, unit: "mg/kg/dose", description: "12mg/kg/dose, Q36H, dilute 50倍 run 1hr", remark: "可以D5W or N/S稀釋25~100倍至2.5~10mg/ml"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:29, PNA_max:Infinity, PMA_min: 0, PMA_max: 28, BW_min: 0, BW_max: Infinity  , frequency: "Q24H", dose: 12, unit: "mg/kg/dose", description: "12mg/kg/dose, Q24H, dilute 50倍 run 1hr", remark: "可以D5W or N/S稀釋25~100倍至2.5~10mg/ml"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 30, PMA_max: 34, BW_min: 0, BW_max: Infinity  , frequency: "Q36H", dose: 12, unit: "mg/kg/dose", description: "12mg/kg/dose, Q36H, dilute 50倍 run 1hr", remark: "可以D5W or N/S稀釋25~100倍至2.5~10mg/ml"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 8, PNA_max:Infinity, PMA_min: 30, PMA_max: 34, BW_min: 0, BW_max: Infinity  , frequency: "Q24H", dose: 12, unit: "mg/kg/dose", description: "12mg/kg/dose, Q24H, dilute 50倍 run 1hr", remark: "可以D5W or N/S稀釋25~100倍至2.5~10mg/ml"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 35, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q24H", dose: 12, unit: "mg/kg/dose", description: "12mg/kg/dose, Q24H, dilute 50倍 run 1hr", remark: "可以D5W or N/S稀釋25~100倍至2.5~10mg/ml"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 8, PNA_max:Infinity, PMA_min: 35, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q18H", dose: 12, unit: "mg/kg/dose", description: "12mg/kg/dose, Q18H, dilute 50倍 run 1hr", remark: "可以D5W or N/S稀釋25~100倍至2.5~10mg/ml"}, 
        ]
      },
      'Cefazolin' :{
        'standard': [ 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 28, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q12H, 泡成100mg/ml, diluted with N/S to 2ml run 30 mins", remark: "(1)20~25mg/kg/dose(2)若是信華注射劑，改以7ml D/W泡成 142MG/mL, 所需量 DILUTE WITH N/S TO 2ML, run 30 mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:29, PNA_max: Infinity, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q8H, 泡成100mg/ml, diluted with N/S to 2ml run 30 mins", remark: "(1)20~25mg/kg/dose(2)若是信華注射劑，改以7ml D/W泡成 142MG/mL, 所需量 DILUTE WITH N/S TO 2ML, run 30 mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 14, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q12H, 泡成100mg/ml, diluted with N/S to 2ml run 30 mins", remark: "(1)20~25mg/kg/dose(2)若是信華注射劑，改以7ml D/W泡成 142MG/mL, 所需量 DILUTE WITH N/S TO 2ML, run 30 mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:15, PNA_max: Infinity, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q8H, 泡成100mg/ml, diluted with N/S to 2ml run 30 mins", remark: "(1)20~25mg/kg/dose(2)若是信華注射劑，改以7ml D/W泡成 142MG/mL, 所需量 DILUTE WITH N/S TO 2ML, run 30 mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q12H, 泡成100mg/ml, diluted with N/S to 2ml run 30 mins", remark: "(1)20~25mg/kg/dose(2)若是信華注射劑，改以7ml D/W泡成 142MG/mL, 所需量 DILUTE WITH N/S TO 2ML, run 30 mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q8H, 泡成100mg/ml, diluted with N/S to 2ml run 30 mins", remark: "(1)20~25mg/kg/dose(2)若是信華注射劑，改以7ml D/W泡成 142MG/mL, 所需量 DILUTE WITH N/S TO 2ML, run 30 mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 45, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q6H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q6H, 泡成100mg/ml, diluted with N/S to 2ml run 30 mins", remark: "(1)20~25mg/kg/dose(2)若是信華注射劑，改以7ml D/W泡成 142MG/mL, 所需量 DILUTE WITH N/S TO 2ML, run 30 mins"} 
        ]
      },
      'Oxacillin' :{
        'standard': [ 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 28, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q12H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:29, PNA_max: Infinity, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q8H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 14, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q12H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:15, PNA_max: Infinity, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q8H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q12H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q8H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 45, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q6H", dose: 25, unit: "mg/kg/dose", description: "25mg/kg/dose, Q6H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}
        ],
        'meningitis': [ 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 28, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 50, unit: "mg/kg/dose", description: "50mg/kg/dose, Q12H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:29, PNA_max: Infinity, PMA_min: 0, PMA_max: 29, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 50, unit: "mg/kg/dose", description: "50mg/kg/dose, Q8H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 14, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 50, unit: "mg/kg/dose", description: "50mg/kg/dose, Q12H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:15, PNA_max: Infinity, PMA_min: 30, PMA_max: 36, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 50, unit: "mg/kg/dose", description: "50mg/kg/dose, Q8H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 7, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 50, unit: "mg/kg/dose", description: "50mg/kg/dose, Q12H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 37, PMA_max: 44, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 50, unit: "mg/kg/dose", description: "50mg/kg/dose, Q8H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 45, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q6H", dose: 50, unit: "mg/kg/dose", description: "50mg/kg/dose, Q6H, D/W 10ml dilute to 100mg/ml, then N/S dilute to 2ml run 30mins"}
        ]
      },
      'Tazocin' :{
        'standard': [ 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 28      , PMA_min:  0, PMA_max: 29      , BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 112.5, unit: "mg/kg/dose", description: "以Piperacillin計 100mg/kg/dose, Q12H, DILUTE IN D/W 8.5 ML to 10ml, 所需量再以N/S dilute to 5倍, RUN 30MINS"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:29, PNA_max: Infinity, PMA_min:  0, PMA_max: 29      , BW_min: 0, BW_max: Infinity  , frequency: "Q8H" , dose: 112.5, unit: "mg/kg/dose", description: "以Piperacillin計 100mg/kg/dose, Q8H, DILUTE IN D/W 8.5 ML to 10ml, 所需量再以N/S dilute to 5倍, RUN 30MINS"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 14      , PMA_min: 30, PMA_max: 36      , BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 112.5, unit: "mg/kg/dose", description: "以Piperacillin計 100mg/kg/dose, Q12H, DILUTE IN D/W 8.5 ML to 10ml, 所需量再以N/S dilute to 5倍, RUN 30MINS"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min:15, PNA_max: Infinity, PMA_min: 30, PMA_max: 36      , BW_min: 0, BW_max: Infinity  , frequency: "Q8H" , dose: 112.5, unit: "mg/kg/dose", description: "以Piperacillin計 100mg/kg/dose, Q8H, DILUTE IN D/W 8.5 ML to 10ml, 所需量再以N/S dilute to 5倍, RUN 30MINS"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 7       , PMA_min: 37, PMA_max: 44      , BW_min: 0, BW_max: Infinity  , frequency: "Q12H", dose: 112.5, unit: "mg/kg/dose", description: "以Piperacillin計 100mg/kg/dose, Q12H, DILUTE IN D/W 8.5 ML to 10ml, 所需量再以N/S dilute to 5倍, RUN 30MINS"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 8, PNA_max: Infinity, PMA_min: 37, PMA_max: 44      , BW_min: 0, BW_max: Infinity  , frequency: "Q8H" , dose: 112.5, unit: "mg/kg/dose", description: "以Piperacillin計 100mg/kg/dose, Q8H, DILUTE IN D/W 8.5 ML to 10ml, 所需量再以N/S dilute to 5倍, RUN 30MINS"}, 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: Infinity, PMA_min: 45, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H" , dose: 112.5, unit: "mg/kg/dose", description: "以Piperacillin計 100mg/kg/dose, Q8H, DILUTE IN D/W 8.5 ML to 10ml, 所需量再以N/S dilute to 5倍, RUN 30MINS"}
        ]
      },
      'Augmentin' :{
        'standard': [ 
          {GA_min:  0, GA_max: Infinity, PNA_min: 0, PNA_max: 84      , PMA_min:  0, PMA_max: Infinity, BW_min: 0, BW_max: Infinity  , frequency: "Q8H", dose: 30, unit: "mg/kg/dose", description: "以Amoxicillin計25mg/kg/dose, Q8H, 使用19.1 ml D/W 泡成60mg/ml複方濃度, 所需量dilute with D/W to 2ml run 30m min", remark: "(1)此為1000mg Amoxicillin + 200mg Clavulanic acid，不同比例的劑量可能不同，請再次確認(2)口服水劑以Amoxicillin計15mg/kg/dose Q12H"} 
        ]
      }
    };


    // *****************************************
    // 計算常用antibiotics配置
    // *****************************************
    // 先找出該藥品根據體重GA年紀等條件的配方
    function findAntiNBDrugSpec(drugName, condition, BW, GA, PNA, PMA) {
      const antiDrugSpec = antiNBDrugSpecs[drugName];
      if (!antiDrugSpec || !antiDrugSpec[condition]) return null;
      return antiDrugSpec[condition].find(spec => spec.BW_min <= BW && BW <= spec.BW_max && spec.GA_min <= GA && GA <= spec.GA_max && spec.PNA_min <= PNA && PNA <= spec.PNA_max && spec.PMA_min <= PMA && PMA <= spec.PMA_max) || null;
    }

    // 計算antibiotics配置
    function calculateAntibioticsForNB() {
      //歸零
      document.getElementById('anti_NB_standard_dose_text').textContent = "";
      document.getElementById('anti_NB_meningitis_dose_text').textContent = "";
      document.getElementById('anti_NB_standard_dose_description_text').textContent = "";
      document.getElementById('anti_NB_meningitis_dose_description_text').textContent = "";
      document.getElementById('anti_NB_dose_remark').textContent = "";

      //讀取輸入值
      const antiNBDrugName = document.getElementById('anti_NB_drug_name').value;
      const antiNBBW = parseFloat(document.getElementById('anti_NB_BW').value) || 0;
      const antiNBGAWeek = parseFloat(document.getElementById('anti_NB_gestational_age_week').value) || 0;
      const antiNBGADay = parseFloat(document.getElementById('anti_NB_gestational_age_day').value);
      const antiNBBirthday = new Date(document.getElementById('anti_NB_birthday').value);
      console.log(!0);

      //檢查輸入值
      if (!antiNBDrugName || !antiNBBW || !antiNBGAWeek || (antiNBGADay>=7) || !antiNBBirthday) {
        console.error("Missing or incorrect inputs!");
        console.log(`antiNBDrugName: ${antiNBDrugName}, antiNBBW: ${antiNBBW}, antiNBGAWeek: ${antiNBGAWeek}, antiNBGADay: ${antiNBGADay}, antiNBBirthday: ${antiNBBirthday}`);
        document.getElementById('anti_NB_standard_dose_description_text').textContent = "Missing or incorrect input values";
        document.getElementById('anti_NB_meningitis_dose_description_text').textContent = "Missing or incorrect input values";
        return;
      }


      //計算PNA
      const antiNBPNA = Math.floor((new Date() - antiNBBirthday) / (1000 * 60 * 60 * 24));
      console.log(`PNA: ${antiNBPNA}`);

      //計算PMA
      const antiNBPMAWeek = antiNBGAWeek + Math.floor( (antiNBPNA+antiNBGADay) / 7);
      console.log(`PMA complete weeks: ${antiNBPMAWeek}`);

      
      //取得藥物資料
      const antiNBDrugSpecStandardDose = findAntiNBDrugSpec(antiNBDrugName, 'standard', antiNBBW, antiNBGAWeek, antiNBPNA, antiNBPMAWeek);
      const antiNBDrugSpecMeningitisDose = findAntiNBDrugSpec(antiNBDrugName, 'meningitis', antiNBBW, antiNBGAWeek, antiNBPNA, antiNBPMAWeek);

      // 若antiNBDrugSpecStandardDose有值，則計算；若無則顯示錯誤訊息
      if (antiNBDrugSpecStandardDose) {
        //計算amount/kg/dose
        let antiNBDrugSpecStandardDoseAmount = (antiNBDrugSpecStandardDose.dose*(antiNBBW/1000)).toFixed(2);
        console.log(`Standard Dose: ${antiNBDrugSpecStandardDoseAmount} = ${antiNBDrugSpecStandardDose.dose} * (${antiNBBW}/1000)`); 
        //輸出成文字
        let antiNBDrugStandardDoseText   = `${antiNBDrugSpecStandardDoseAmount} ${(antiNBDrugSpecStandardDose.unit).split("/")[0]} ${antiNBDrugSpecStandardDose.frequency}`;
        let antiNBDrugStandardDoseDescriptionText   = `${antiNBDrugSpecStandardDose.description}`;
        //輸出到網頁
        document.getElementById('anti_NB_standard_dose_text').textContent = antiNBDrugStandardDoseText;
        document.getElementById('anti_NB_standard_dose_description_text').textContent = antiNBDrugStandardDoseDescriptionText;
        document.getElementById('anti_NB_dose_remark').textContent += antiNBDrugSpecStandardDose.remark;
      } else {
        //沒有standard dose, 顯示錯誤訊息
        console.error(`No standard dose suggestion found for ${antiNBDrugName} with BW=${antiNBBW}, GA=${antiNBGAWeek}w, PNA=${antiNBPNA}d.`);
        document.getElementById('anti_NB_standard_dose_text').textContent = "-";
        document.getElementById('anti_NB_standard_dose_description_text').textContent = "No standard dose suggestion found.";
      }
      
      // 若antiNBDrugSpecStandardDose有值，則計算；若無則顯示錯誤訊息
      if (antiNBDrugSpecMeningitisDose) {
        //計算amount/kg/dose
        let antiNBDrugSpecMeningitisDoseAmount = antiNBDrugSpecMeningitisDose? (antiNBDrugSpecMeningitisDose.dose*(antiNBBW/1000)).toFixed(2):"No meningitis dose suggestion found";
        console.log(`Meningitis Dose: ${antiNBDrugSpecMeningitisDoseAmount} = ${antiNBDrugSpecMeningitisDose.dose} * (${antiNBBW}/1000)`);
        //輸出成文字
        let antiNBDrugMeningitisDoseText = `${antiNBDrugSpecMeningitisDoseAmount} ${(antiNBDrugSpecMeningitisDose.unit).split("/")[0]} ${antiNBDrugSpecMeningitisDose.frequency}`;
        let antiNBDrugMeningitisDoseDescriptionText = `${antiNBDrugSpecMeningitisDose.description}`;
        //輸出到網頁
        document.getElementById('anti_NB_meningitis_dose_text').textContent = antiNBDrugMeningitisDoseText;
        document.getElementById('anti_NB_meningitis_dose_description_text').textContent = antiNBDrugMeningitisDoseDescriptionText;
      } else {
        //沒有Meningitis dose, 顯示錯誤訊息
        console.error(`No meningitis dose suggestion found for ${antiNBDrugName} with BW=${antiNBBW}, GA=${antiNBGAWeek}w, PNA=${antiNBPNA}d.`);
        document.getElementById('anti_NB_meningitis_dose_text').textContent = "-";
        document.getElementById('anti_NB_meningitis_dose_description_text').textContent = "No meningitis dose suggestion found.";
      }
    }


    // *****************************************
    // 計算早產兒生長指標
    // *****************************************    
    function calculateGrowthIndex() {
      //歸零
      document.getElementById('growth_output').innerHTML = "GA:<br>Gender:<br>BBW:<br>BBL:<br>BHC:<br>Ponderal index:";

      //讀取輸入值
      const growthGAWeek = parseFloat(document.getElementById('growth_GA_week').value) || 0;
      const growthGADay = parseFloat(document.getElementById('growth_GA_day').value) || 0;
      const growthGender = document.getElementById('growth_gender').value;
      const growthBBW = parseFloat(document.getElementById('growth_BBW').value) || 0;
      const growthBBL = parseFloat(document.getElementById('growth_BBL').value) || 0;
      const growthBHC = parseFloat(document.getElementById('growth_BHC').value) || 0;
      
      //檢查輸入值
      if (!growthGAWeek || (growthGADay>=7) || !growthGender || !growthBBW || !growthBBL || !growthBHC) {
        console.error("Missing or incorrect inputs!");
        console.log(`growthGAWeek: ${growthGAWeek}, growthGADay: ${growthGADay}, growthGender: ${growthGender}, growthBBW: ${growthBBW}, growthBBL: ${growthBBL}, growthBHC: ${growthBHC}`);
        return;
      }

      //計算指標

      //輸出成文字


      //輸出到網頁
      document.getElementById('growth_index_text').textContent = growthIndexText;

    }
    

    // *****************************************
    // 對傳入的文字進行解析並加減乘除
    // *****************************************
    function parseExpression(expression) {
      expression = expression.replace(/\s+/g, ""); // 移除掉多餘的空格
      expression = expression.replace(/[+\-*\/]$/, ""); // 移除結尾的 +, -, *, / 符號
      try {
        return math.evaluate(expression); // 使用 math.js 的 evaluate 方法計算表達式
      } catch (error) {
          console.error("Expression Error:", error);
          return 0; // 若計算過程中有錯誤，返回 0
      }
    }


    // *****************************************
    // 新增新的輸入行
    // *****************************************
    function addNewElement( referenceNode, typeOfElement) {
      // Get the parent of the reference node
      let parent = referenceNode.parentNode;     
      let grandParent = parent.parentNode;

      // Create a new row for the inputs
      let newDiv = document.createElement('div');
      newDiv.classList.add('input-group'); //加入屬性class
      newDiv.classList.add('added-element'); // 新增class用來辨識是否為新增的元素
      switch(typeOfElement){
        case('fluid_other_solution'):
          newDiv.innerHTML = `
            <span class="input-group-text justify-content-center" style="width: 15%;">Other</span>
            <select name="fluid_other_solution_base" class="form-select text-center advanced-version-only" onchange="calculateFluid()">
              <option value=""></option>
              <option value="D/W">D/W base</option>
              <option value="D5W">D5W base</option>
              <option value="D10W">D10W base</option>
              <option value="H/S">H/S base</option>
              <option value="N/S">N/S base</option>
              <option value="L/R">L/R base</option>
            </select>
            <input type="text" name="fluid_other_solution_rate" class="form-control text-center" oninput="calculateFluid()" />
            <span class="input-group-text justify-content-center" style="width:10%;">ml/hr</span>
            <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'fluid_other_solution')">+</button>
          `;
          break;
        case('fluid_other_in_IO'):
          newDiv.innerHTML = `
            <span class="input-group-text justify-content-center" style="width: 15%;">Other</span>
            <select name="fluid_other_in_IO_base" class="form-select text-center advanced-version-only" onchange="calculateFluid()">
              <option value=""></option>
              <option value="3% NaCl">3% NaCl</option>
            </select>
            <input type="text" name="fluid_other_in_IO" class="form-control text-center" oninput="calculateFluid()" />
            <span class="input-group-text justify-content-center" style="width:10%;">ml/day</span>
            <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'fluid_other_in_IO')">+</button>
          `;
          break;
        case('GIR_dex'):
          newDiv.innerHTML = `
            <span class="input-group-text justify-content-center" style="width: 15%;">Dex</span>
            <input name="GIR_dex" type="number" class="form-control text-center" oninput="calculateGIR()">
            <span class="input-group-text">%</span>
            <input name="GIR_rate" type="text" class="form-control text-center" oninput="calculateGIR()">
            <span class="input-group-text" style="width: 10%;">ml/hr</span>
            <button class="btn btn-light" style="border-color: #e0e3e7; width: 5%;" onclick="addNewElement(this, 'GIR_dex')">+</button>
          `;
          break;
      }
      grandParent.insertBefore(newDiv, parent);

      // 重新載入，將新元素根據進階版與否處理
      fluidVersionToggle(fluidVersion);
    }    


    // *****************************************
    // 自動載入今天日期
    // *****************************************
    function loadTodayDate(elementID) {
      let today = new Date().toISOString().split('T')[0];
      console.log(`Today: ${today}`);

      document.getElementById(elementID).value = today;
      console.log(`Today: ${today}`);
    }

    // *****************************************
    //對每個.copy-item新增onclick事件，讓點擊後複製其data-content的內容，若沒有data-content，則複製其textContent
    // *****************************************
    function addCopyEventListener() {
      document.querySelectorAll('.copy-item').forEach(item => {
        item.addEventListener('click', () => {
          let content = item.dataset.content || item.innerHTML; // 取得 HTML
          content = content.replace(/<br\s*\/?>/g, "\n"); // 替換 <br> 為 \n

          navigator.clipboard.writeText(content).then(() => {
            console.log(`已複製: ${content}`);
          }).catch(err => {
            console.error('複製失敗:', err);
          });
        });
      });
    }



    // *****************************************    
    // reset input
    // *****************************************
    function resetForm(elementID){
      let targetDiv = document.getElementById(elementID); // 獲取指定的 div
      if (!targetDiv) return;

      let inputs = targetDiv.querySelectorAll("input, select");
      inputs.forEach(input => {
          if (input.type === "number" || input.type === "text") {
              input.value = "";
          } else if (input.tagName === "SELECT") {
              input.selectedIndex = 0;
          }
      });

      // 清除該區域內的計算結果
      targetDiv.querySelectorAll(".copy-item").forEach(el => el.textContent = "");

      // 清除新增的元素
      targetDiv.querySelectorAll('.added-element').forEach(el => el.remove());

      // 重新載入預設值
      switch(elementID){
        case 'fluid_content':
          if (fluidVersion==="advanced"){
            document.getElementById('fluid_TPN_dex').selectedIndex = 3; //index 3 = 10%
            document.getElementById('fluid_TPN_Na').selectedIndex = 4;  //index 4 = 40;
            document.getElementById('fluid_TPN_K').selectedIndex = 2;   //index 2 = 20;
            document.getElementById('fluid_TPN_Ca').selectedIndex = 0;  //index 0 = 20;
            document.getElementById('fluid_TPN_P').selectedIndex = 2;   //index 2 =  9;
            document.getElementById('fluid_TPN_Mg').selectedIndex = 2;  //index 2 =  4;
          }
          calculateFluid();
          fluidCalclator();
          break;
        case 'GIR_content':
          document.getElementById('GIR_dex_default_10_percent').value = 10;
          document.getElementById('GIR_dex_default_5_percent').value = 5;
          calculateGIR();
          break;
        case 'dex_content':
          document.getElementById('dextrose_original_concentration').value = 5;
          document.getElementById('dextrose_original_amount').value = 500;
          document.getElementById('dextrose_add_concentration').value = 50;
          calculateDex();
          break;
        case 'umbilical_cath_len_content':
          calculateUmbilicalCathLen();
          break;
        case 'drug_content':
          calculateDrugPreperation();
          break;
        case 'anti_NB_content':
          loadTodayDate('anti_NB_birthday');
          calculateAntibioticsForNB();
          break
      }
      addCopyEventListener();
    }

    // 載入今天日期
    loadTodayDate('anti_NB_birthday');


    // 頁面載入時先執行一次計算
    calculateFluid();
    calculateGIR();
    calculateDex();
    calculateUmbilicalCathLen();
    calculateDrugPreperation();
    calculateAntibioticsForNB();
    addCopyEventListener();
    calculateGrowthIndex();
    fluidVersionToggle('basic');
  </script>
</body>

</html>
